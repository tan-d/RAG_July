(function(M,V){typeof exports=="object"&&typeof module<"u"?V(exports):typeof define=="function"&&define.amd?define(["exports"],V):(M=typeof globalThis<"u"?globalThis:M||self,V(M.RefactChat={}))})(this,function(M){"use strict";var tu=Object.defineProperty;var ru=(M,V,re)=>V in M?tu(M,V,{enumerable:!0,configurable:!0,writable:!0,value:re}):M[V]=re;var Zt=(M,V,re)=>ru(M,typeof V!="symbol"?V+"":V,re);function V(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function re(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var dt=()=>Math.random().toString(36).substring(7).split("").join("."),Ln={INIT:`@@redux/INIT${dt()}`,REPLACE:`@@redux/REPLACE${dt()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${dt()}`},jt=Ln;function ne(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function xn(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:jt.INIT})>"u")throw new Error(re(12));if(typeof r(void 0,{type:jt.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(re(13))})}function zn(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const u=t[s];typeof e[u]=="function"&&(r[u]=e[u])}const n=Object.keys(r);let i;try{xn(r)}catch(s){i=s}return function(u={},c){if(i)throw i;let o=!1;const y={};for(let l=0;l<n.length;l++){const h=n[l],a=r[h],d=u[h],g=a(d,c);if(typeof g>"u")throw c&&c.type,new Error(re(14));y[h]=g,o=o||g!==d}return o=o||n.length!==Object.keys(u).length,o?y:u}}function er(e){return ne(e)&&"type"in e&&typeof e.type=="string"}var pt=Symbol.for("immer-nothing"),ve=Symbol.for("immer-draftable"),H=Symbol.for("immer-state");function z(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var se=Object.getPrototypeOf;function j(e){return!!e&&!!e[H]}function Z(e){var t;return e?tr(e)||Array.isArray(e)||!!e[ve]||!!((t=e.constructor)!=null&&t[ve])||Ce(e)||Re(e):!1}var Qn=Object.prototype.constructor.toString();function tr(e){if(!e||typeof e!="object")return!1;const t=se(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Qn}function Kn(e){return j(e)||z(15,e),e[H].base_}function Se(e,t){ae(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ae(e){const t=e[H];return t?t.type_:Array.isArray(e)?1:Ce(e)?2:Re(e)?3:0}function be(e,t){return ae(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function yt(e,t){return ae(e)===2?e.get(t):e[t]}function rr(e,t,r){const n=ae(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Wn(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Ce(e){return e instanceof Map}function Re(e){return e instanceof Set}function ue(e){return e.copy_||e.base_}function ht(e,t){if(Ce(e))return new Map(e);if(Re(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=tr(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[H];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const u=i[s],c=n[u];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[u]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[u]})}return Object.create(se(e),n)}else{const n=se(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function gt(e,t=!1){return Ke(e)||j(e)||!Z(e)||(ae(e)>1&&(e.set=e.add=e.clear=e.delete=Bn),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>gt(n,!0))),e}function Bn(){z(2)}function Ke(e){return Object.isFrozen(e)}var mt={};function ce(e){const t=mt[e];return t||z(0,e),t}function Hn(e,t){mt[e]||(mt[e]=t)}var we;function nr(){return we}function Vn(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ir(e,t){t&&(ce("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _t(e){vt(e),e.drafts_.forEach(Gn),e.drafts_=null}function vt(e){e===we&&(we=e.parent_)}function or(e){return we=Vn(we,e)}function Gn(e){const t=e[H];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function sr(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[H].modified_&&(_t(t),z(4)),Z(e)&&(e=We(t,e),t.parent_||Be(t,e)),t.patches_&&ce("Patches").generateReplacementPatches_(r[H].base_,e,t.patches_,t.inversePatches_)):e=We(t,r,[]),_t(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==pt?e:void 0}function We(e,t,r){if(Ke(t))return t;const n=t[H];if(!n)return Se(t,(i,s)=>ar(e,n,t,i,s,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Be(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let s=i,u=!1;n.type_===3&&(s=new Set(i),i.clear(),u=!0),Se(s,(c,o)=>ar(e,n,i,c,o,r,u)),Be(e,i,!1),r&&e.patches_&&ce("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function ar(e,t,r,n,i,s,u){if(j(i)){const c=s&&t&&t.type_!==3&&!be(t.assigned_,n)?s.concat(n):void 0,o=We(e,i,c);if(rr(r,n,o),j(o))e.canAutoFreeze_=!1;else return}else u&&r.add(i);if(Z(i)&&!Ke(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;We(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Be(e,i)}}function Be(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gt(t,r)}function Jn(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:nr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=St;r&&(i=[n],s=Te);const{revoke:u,proxy:c}=Proxy.revocable(i,s);return n.draft_=c,n.revoke_=u,c}var St={get(e,t){if(t===H)return e;const r=ue(e);if(!be(r,t))return Yn(e,r,t);const n=r[t];return e.finalized_||!Z(n)?n:n===bt(e.base_,t)?(Rt(e),e.copy_[t]=wt(n,e)):n},has(e,t){return t in ue(e)},ownKeys(e){return Reflect.ownKeys(ue(e))},set(e,t,r){const n=ur(ue(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=bt(ue(e),t),s=i==null?void 0:i[H];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Wn(r,i)&&(r!==void 0||be(e.base_,t)))return!0;Rt(e),Ct(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return bt(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Rt(e),Ct(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ue(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){z(11)},getPrototypeOf(e){return se(e.base_)},setPrototypeOf(){z(12)}},Te={};Se(St,(e,t)=>{Te[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Te.deleteProperty=function(e,t){return Te.set.call(this,e,t,void 0)},Te.set=function(e,t,r){return St.set.call(this,e[0],t,r,e[0])};function bt(e,t){const r=e[H];return(r?ue(r):e)[t]}function Yn(e,t,r){var i;const n=ur(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function ur(e,t){if(!(t in e))return;let r=se(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=se(r)}}function Ct(e){e.modified_||(e.modified_=!0,e.parent_&&Ct(e.parent_))}function Rt(e){e.copy_||(e.copy_=ht(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Xn=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const u=this;return function(o=s,...y){return u.produce(o,l=>r.call(this,l,...y))}}typeof r!="function"&&z(6),n!==void 0&&typeof n!="function"&&z(7);let i;if(Z(t)){const s=or(this),u=wt(t,void 0);let c=!0;try{i=r(u),c=!1}finally{c?_t(s):vt(s)}return ir(s,n),sr(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===pt&&(i=void 0),this.autoFreeze_&&gt(i,!0),n){const s=[],u=[];ce("Patches").generateReplacementPatches_(t,i,s,u),n(s,u)}return i}else z(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(u,...c)=>this.produceWithPatches(u,o=>t(o,...c));let n,i;return[this.produce(t,r,(u,c)=>{n=u,i=c}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Z(e)||z(8),j(e)&&(e=Zn(e));const t=or(this),r=wt(e,void 0);return r[H].isManual_=!0,vt(t),r}finishDraft(e,t){const r=e&&e[H];(!r||!r.isManual_)&&z(9);const{scope_:n}=r;return ir(n,t),sr(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=ce("Patches").applyPatches_;return j(e)?n(e,t):this.produce(e,i=>n(i,t))}};function wt(e,t){const r=Ce(e)?ce("MapSet").proxyMap_(e,t):Re(e)?ce("MapSet").proxySet_(e,t):Jn(e,t);return(t?t.scope_:nr()).drafts_.push(r),r}function Zn(e){return j(e)||z(10,e),cr(e)}function cr(e){if(!Z(e)||Ke(e))return e;const t=e[H];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ht(e,t.scope_.immer_.useStrictShallowCopy_)}else r=ht(e,!0);return Se(r,(n,i)=>{rr(r,n,cr(i))}),t&&(t.finalized_=!1),r}function jn(){const t="replace",r="add",n="remove";function i(a,d,g,v){switch(a.type_){case 0:case 2:return u(a,d,g,v);case 1:return s(a,d,g,v);case 3:return c(a,d,g,v)}}function s(a,d,g,v){let{base_:_,assigned_:b}=a,m=a.copy_;m.length<_.length&&([_,m]=[m,_],[g,v]=[v,g]);for(let f=0;f<_.length;f++)if(b[f]&&m[f]!==_[f]){const p=d.concat([f]);g.push({op:t,path:p,value:h(m[f])}),v.push({op:t,path:p,value:h(_[f])})}for(let f=_.length;f<m.length;f++){const p=d.concat([f]);g.push({op:r,path:p,value:h(m[f])})}for(let f=m.length-1;_.length<=f;--f){const p=d.concat([f]);v.push({op:n,path:p})}}function u(a,d,g,v){const{base_:_,copy_:b}=a;Se(a.assigned_,(m,f)=>{const p=yt(_,m),S=yt(b,m),R=f?be(_,m)?t:r:n;if(p===S&&R===t)return;const C=d.concat(m);g.push(R===n?{op:R,path:C}:{op:R,path:C,value:S}),v.push(R===r?{op:n,path:C}:R===n?{op:r,path:C,value:h(p)}:{op:t,path:C,value:h(p)})})}function c(a,d,g,v){let{base_:_,copy_:b}=a,m=0;_.forEach(f=>{if(!b.has(f)){const p=d.concat([m]);g.push({op:n,path:p,value:f}),v.unshift({op:r,path:p,value:f})}m++}),m=0,b.forEach(f=>{if(!_.has(f)){const p=d.concat([m]);g.push({op:r,path:p,value:f}),v.unshift({op:n,path:p,value:f})}m++})}function o(a,d,g,v){g.push({op:t,path:[],value:d===pt?void 0:d}),v.push({op:t,path:[],value:a})}function y(a,d){return d.forEach(g=>{const{path:v,op:_}=g;let b=a;for(let S=0;S<v.length-1;S++){const R=ae(b);let C=v[S];typeof C!="string"&&typeof C!="number"&&(C=""+C),(R===0||R===1)&&(C==="__proto__"||C==="constructor")&&z(19),typeof b=="function"&&C==="prototype"&&z(19),b=yt(b,C),typeof b!="object"&&z(18,v.join("/"))}const m=ae(b),f=l(g.value),p=v[v.length-1];switch(_){case t:switch(m){case 2:return b.set(p,f);case 3:z(16);default:return b[p]=f}case r:switch(m){case 1:return p==="-"?b.push(f):b.splice(p,0,f);case 2:return b.set(p,f);case 3:return b.add(f);default:return b[p]=f}case n:switch(m){case 1:return b.splice(p,1);case 2:return b.delete(p);case 3:return b.delete(g.value);default:return delete b[p]}default:z(17,_)}}),a}function l(a){if(!Z(a))return a;if(Array.isArray(a))return a.map(l);if(Ce(a))return new Map(Array.from(a.entries()).map(([g,v])=>[g,l(v)]));if(Re(a))return new Set(Array.from(a).map(l));const d=Object.create(se(a));for(const g in a)d[g]=l(a[g]);return be(a,ve)&&(d[ve]=a[ve]),d}function h(a){return j(a)?l(a):a}Hn("Patches",{applyPatches_:y,generatePatches_:i,generateReplacementPatches_:o})}var G=new Xn,Oe=G.produce,fr=G.produceWithPatches.bind(G);G.setAutoFreeze.bind(G),G.setUseStrictShallowCopy.bind(G);var lr=G.applyPatches.bind(G);G.createDraft.bind(G),G.finishDraft.bind(G);function ei(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function ti(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function ri(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var dr=e=>Array.isArray(e)?e:[e];function ni(e){const t=Array.isArray(e[0])?e[0]:e;return ri(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function ii(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var oi=class{constructor(e){this.value=e}deref(){return this.value}},si=typeof WeakRef<"u"?WeakRef:oi,ai=0,pr=1;function He(){return{s:ai,v:void 0,o:null,p:null}}function Ve(e,t={}){let r=He();const{resultEqualityCheck:n}=t;let i,s=0;function u(){var h;let c=r;const{length:o}=arguments;for(let a=0,d=o;a<d;a++){const g=arguments[a];if(typeof g=="function"||typeof g=="object"&&g!==null){let v=c.o;v===null&&(c.o=v=new WeakMap);const _=v.get(g);_===void 0?(c=He(),v.set(g,c)):c=_}else{let v=c.p;v===null&&(c.p=v=new Map);const _=v.get(g);_===void 0?(c=He(),v.set(g,c)):c=_}}const y=c;let l;if(c.s===pr)l=c.v;else if(l=e.apply(null,arguments),s++,n){const a=((h=i==null?void 0:i.deref)==null?void 0:h.call(i))??i;a!=null&&n(a,l)&&(l=a,s!==0&&s--),i=typeof l=="object"&&l!==null||typeof l=="function"?new si(l):l}return y.s=pr,y.v=l,l}return u.clearCache=()=>{r=He(),u.resetResultsCount()},u.resultsCount=()=>s,u.resetResultsCount=()=>{s=0},u}function ui(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let s=0,u=0,c,o={},y=i.pop();typeof y=="object"&&(o=y,y=i.pop()),ei(y,`createSelector expects an output function after the inputs, but received: [${typeof y}]`);const l={...r,...o},{memoize:h,memoizeOptions:a=[],argsMemoize:d=Ve,argsMemoizeOptions:g=[],devModeChecks:v={}}=l,_=dr(a),b=dr(g),m=ni(i),f=h(function(){return s++,y.apply(null,arguments)},..._),p=d(function(){u++;const R=ii(m,arguments);return c=f.apply(null,R),c},...b);return Object.assign(p,{resultFunc:y,memoizedResultFunc:f,dependencies:m,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>c,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:h,argsMemoize:d})};return Object.assign(n,{withTypes:()=>n}),n}var pe=ui(Ve),ci=Object.assign((e,t=pe)=>{ti(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((u,c,o)=>(u[r[o]]=c,u),{}))},{withTypes:()=>ci}),fi=e=>e&&typeof e.match=="function";function A(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(J(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>er(n)&&n.type===e,r}function yr(e){return Z(e)?Oe(e,()=>{}):e}function hr(e,t,r){if(e.has(t)){let i=e.get(t);return r.update&&(i=r.update(i,t,e),e.set(t,i)),i}if(!r.insert)throw new Error(J(10));const n=r.insert(t,e);return e.set(t,n),n}var Ee="RTK_autoBatch",Ae=()=>e=>({payload:e,meta:{[Ee]:!0}});function gr(e){const t={},r=[];let n;const i={addCase(s,u){const c=typeof s=="string"?s:s.type;if(!c)throw new Error(J(28));if(c in t)throw new Error(J(29));return t[c]=u,i},addMatcher(s,u){return r.push({matcher:s,reducer:u}),i},addDefaultCase(s){return n=s,i}};return e(i),[t,r,n]}function li(e){return typeof e=="function"}function Pe(e,t){let[r,n,i]=gr(t),s;if(li(e))s=()=>yr(e());else{const c=yr(e);s=()=>c}function u(c=s(),o){let y=[r[o.type],...n.filter(({matcher:l})=>l(o)).map(({reducer:l})=>l)];return y.filter(l=>!!l).length===0&&(y=[i]),y.reduce((l,h)=>{if(h)if(j(l)){const d=h(l,o);return d===void 0?l:d}else{if(Z(l))return Oe(l,a=>h(a,o));{const a=h(l,o);if(a===void 0){if(l===null)return l;throw new Error(J(9))}return a}}return l},c)}return u.getInitialState=s,u}var mr=(e,t)=>fi(e)?e.match(t):e(t);function te(...e){return t=>e.some(r=>mr(r,t))}function Me(...e){return t=>e.every(r=>mr(r,t))}function Ge(e,t){if(!e||!e.meta)return!1;const r=typeof e.meta.requestId=="string",n=t.indexOf(e.meta.requestStatus)>-1;return r&&n}function ke(e){return typeof e[0]=="function"&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function Tt(...e){return e.length===0?t=>Ge(t,["pending"]):ke(e)?te(...e.map(t=>t.pending)):Tt()(e[0])}function ye(...e){return e.length===0?t=>Ge(t,["rejected"]):ke(e)?te(...e.map(t=>t.rejected)):ye()(e[0])}function Je(...e){const t=r=>r&&r.meta&&r.meta.rejectedWithValue;return e.length===0?Me(ye(...e),t):ke(e)?Me(ye(...e),t):Je()(e[0])}function ie(...e){return e.length===0?t=>Ge(t,["fulfilled"]):ke(e)?te(...e.map(t=>t.fulfilled)):ie()(e[0])}function Ot(...e){return e.length===0?t=>Ge(t,["pending","fulfilled","rejected"]):ke(e)?te(...e.flatMap(t=>[t.pending,t.rejected,t.fulfilled])):Ot()(e[0])}var di="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_r=(e=21)=>{let t="",r=e;for(;r--;)t+=di[Math.random()*64|0];return t},pi=["name","message","stack","code"],Et=class{constructor(e,t){Zt(this,"_type");this.payload=e,this.meta=t}},vr=class{constructor(e,t){Zt(this,"_type");this.payload=e,this.meta=t}},yi=e=>{if(typeof e=="object"&&e!==null){const t={};for(const r of pi)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},Ye=(()=>{function e(t,r,n){const i=A(t+"/fulfilled",(o,y,l,h)=>({payload:o,meta:{...h||{},arg:l,requestId:y,requestStatus:"fulfilled"}})),s=A(t+"/pending",(o,y,l)=>({payload:void 0,meta:{...l||{},arg:y,requestId:o,requestStatus:"pending"}})),u=A(t+"/rejected",(o,y,l,h,a)=>({payload:h,error:(n&&n.serializeError||yi)(o||"Rejected"),meta:{...a||{},arg:l,requestId:y,rejectedWithValue:!!h,requestStatus:"rejected",aborted:(o==null?void 0:o.name)==="AbortError",condition:(o==null?void 0:o.name)==="ConditionError"}}));function c(o){return(y,l,h)=>{const a=n!=null&&n.idGenerator?n.idGenerator(o):_r(),d=new AbortController;let g,v;function _(m){v=m,d.abort()}const b=async function(){var p,S;let m;try{let R=(p=n==null?void 0:n.condition)==null?void 0:p.call(n,o,{getState:l,extra:h});if(gi(R)&&(R=await R),R===!1||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const C=new Promise((w,T)=>{g=()=>{T({name:"AbortError",message:v||"Aborted"})},d.signal.addEventListener("abort",g)});y(s(a,o,(S=n==null?void 0:n.getPendingMeta)==null?void 0:S.call(n,{requestId:a,arg:o},{getState:l,extra:h}))),m=await Promise.race([C,Promise.resolve(r(o,{dispatch:y,getState:l,extra:h,requestId:a,signal:d.signal,abort:_,rejectWithValue:(w,T)=>new Et(w,T),fulfillWithValue:(w,T)=>new vr(w,T)})).then(w=>{if(w instanceof Et)throw w;return w instanceof vr?i(w.payload,a,o,w.meta):i(w,a,o)})])}catch(R){m=R instanceof Et?u(null,a,o,R.payload,R.meta):u(R,a,o)}finally{g&&d.signal.removeEventListener("abort",g)}return n&&!n.dispatchConditionRejection&&u.match(m)&&m.meta.condition||y(m),m}();return Object.assign(b,{abort:_,requestId:a,arg:o,unwrap(){return b.then(hi)}})}}return Object.assign(c,{pending:s,rejected:u,fulfilled:i,settled:te(u,i),typePrefix:t})}return e.withTypes=()=>e,e})();function hi(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function gi(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var mi=Symbol.for("rtk-slice-createasyncthunk");function _i(e,t){return`${e}/${t}`}function vi({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[mi];return function(i){const{name:s,reducerPath:u=s}=i;if(!s)throw new Error(J(11));typeof process<"u";const c=(typeof i.reducers=="function"?i.reducers(bi()):i.reducers)||{},o=Object.keys(c),y={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(f,p){const S=typeof f=="string"?f:f.type;if(!S)throw new Error(J(12));if(S in y.sliceCaseReducersByType)throw new Error(J(13));return y.sliceCaseReducersByType[S]=p,l},addMatcher(f,p){return y.sliceMatchers.push({matcher:f,reducer:p}),l},exposeAction(f,p){return y.actionCreators[f]=p,l},exposeCaseReducer(f,p){return y.sliceCaseReducersByName[f]=p,l}};o.forEach(f=>{const p=c[f],S={reducerName:f,type:_i(s,f),createNotation:typeof i.reducers=="function"};Ri(p)?Ti(S,p,l,t):Ci(S,p,l)});function h(){const[f={},p=[],S=void 0]=typeof i.extraReducers=="function"?gr(i.extraReducers):[i.extraReducers],R={...f,...y.sliceCaseReducersByType};return Pe(i.initialState,C=>{for(let w in R)C.addCase(w,R[w]);for(let w of y.sliceMatchers)C.addMatcher(w.matcher,w.reducer);for(let w of p)C.addMatcher(w.matcher,w.reducer);S&&C.addDefaultCase(S)})}const a=f=>f,d=new Map;let g;function v(f,p){return g||(g=h()),g(f,p)}function _(){return g||(g=h()),g.getInitialState()}function b(f,p=!1){function S(C){let w=C[f];return typeof w>"u"&&p&&(w=_()),w}function R(C=a){const w=hr(d,p,{insert:()=>new WeakMap});return hr(w,C,{insert:()=>{const T={};for(const[O,E]of Object.entries(i.selectors??{}))T[O]=Si(E,C,_,p);return T}})}return{reducerPath:f,getSelectors:R,get selectors(){return R(S)},selectSlice:S}}const m={name:s,reducer:v,actions:y.actionCreators,caseReducers:y.sliceCaseReducersByName,getInitialState:_,...b(u),injectInto(f,{reducerPath:p,...S}={}){const R=p??u;return f.inject({reducerPath:R,reducer:v},S),{...m,...b(R,!0)}}};return m}}function Si(e,t,r,n){function i(s,...u){let c=t(s);return typeof c>"u"&&n&&(c=r()),e(c,...u)}return i.unwrapped=e,i}var fe=vi();function bi(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Ci({type:e,reducerName:t,createNotation:r},n,i){let s,u;if("reducer"in n){if(r&&!wi(n))throw new Error(J(17));s=n.reducer,u=n.prepare}else s=n;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,u?A(e,u):A(e))}function Ri(e){return e._reducerDefinitionType==="asyncThunk"}function wi(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Ti({type:e,reducerName:t},r,n,i){if(!i)throw new Error(J(18));const{payloadCreator:s,fulfilled:u,pending:c,rejected:o,settled:y,options:l}=r,h=i(e,s,l);n.exposeAction(t,h),u&&n.addCase(h.fulfilled,u),c&&n.addCase(h.pending,c),o&&n.addCase(h.rejected,o),y&&n.addMatcher(h.settled,y),n.exposeCaseReducer(t,{fulfilled:u||Xe,pending:c||Xe,rejected:o||Xe,settled:y||Xe})}function Xe(){}function J(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Oi(e){return!(!e||typeof e!="object"||!("function"in e)||!("index"in e))}function Ei(e){return!(!e||typeof e!="object"||!("file_name"in e)||typeof e.file_name!="string"||!("file_action"in e)||typeof e.file_action!="string"||!("line1"in e)||typeof e.line1!="number"||!("line2"in e)||typeof e.line2!="number"||!("lines_remove"in e)||typeof e.lines_remove!="string"||!("lines_add"in e)||typeof e.lines_add!="string")}function Sr(e){return e.role==="user"}function Ai(e){return e.role==="context_file"}function Ze(e){return e.role==="assistant"}function Fe(e){return e.role==="tool"}function br(e){return e.role==="diff"}function At(e){if(!Ze(e))return!1;const t=e.tool_calls;return t?t.every(Oi):!1}function Pi(e){return e.role==="plain_text"}function Mi(e){return e.role==="cd_instruction"}function Cr(e){return!(!e||typeof e!="object"||"role"in e&&e.role!==null&&e.role!=="assistant"||!("content"in e)||typeof e.content!="string")}function ki(e){return!e||typeof e!="object"||!("role"in e)?!1:e.role==="context_file"}function Fi(e){return!e||typeof e!="object"||!("tool_calls"in e)||e.tool_calls===null?!1:Array.isArray(e.tool_calls)}function Ii(e){return!e||typeof e!="object"||!("id"in e)||!("content"in e)||!("role"in e)?!1:e.role==="user"||e.role==="context_file"||e.role==="context_memory"}function Di(e){return!e||typeof e!="object"||!("content"in e)||!("role"in e)||!("tool_call_id"in e)?!1:e.role==="tool"}function $i(e){return!e||typeof e!="object"||!("content"in e)||!("role"in e)?!1:e.role==="diff"}function qi(e){return!e||typeof e!="object"||!("role"in e)?!1:e.role==="plain_text"}function Rr(e){return"choices"in e}function Pt(e){return!(!e||typeof e!="object"||!("memid"in e)||typeof e.memid!="string")}function wr(e){return!(!e||typeof e!="object"||!("files_unprocessed"in e)||typeof e.files_unprocessed!="number"||!("files_total"in e)||typeof e.files_total!="number"||!("requests_made_since_start"in e)||typeof e.requests_made_since_start!="number"||!("vectors_made_since_start"in e)||typeof e.vectors_made_since_start!="number"||!("db_size"in e)||typeof e.db_size!="number"||!("db_cache_size"in e)||typeof e.db_cache_size!="number"||!("state"in e)||typeof e.state!="string"||!("queue_additions"in e)||typeof e.queue_additions!="boolean"||!("vecdb_max_files_hit"in e)||typeof e.vecdb_max_files_hit!="boolean"||!("vecdb_errors"in e)||typeof e.vecdb_errors!="object")}const Tr="/v1/chat",Ni="/v1/caps",Ui="/v1/get-dashboard-plots",Li="/v1/at-command-completion",xi="/v1/at-command-preview",zi="/v1/customization",Qi="/v1/tools",Ki="/v1/tools-check-if-confirmation-needed",Or="/v1/file_edit_tool_dry_run",je="/v1/config-path",Wi="/v1/fullpath",Er="/v1/ping",Bi="/v1/links",Hi="/v1/git-commit",Vi="/v1/integrations",Gi="/v1/integration-get",Ji="/v1/integration-save",Yi="/v1/integration-delete",et="/v1/docker-container-list",Xi="/v1/docker-container-action",Zi="/v1/telemetry-chat",Mt="/v1/telemetry-network",ji="/v1/mem-sub",eo="/v1/mem-add",to="/v1/mem-erase",ro="/v1/mem-update-used",no="/v1/mem-upd",io="/v1/trajectory-save";var Ar=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(Ar||{});function oo(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var Pr=ne;function Mr(e,t){if(e===t||!(Pr(e)&&Pr(t)||Array.isArray(e)&&Array.isArray(t)))return t;const r=Object.keys(t),n=Object.keys(e);let i=r.length===n.length;const s=Array.isArray(t)?[]:{};for(const u of r)s[u]=Mr(e[u],t[u]),i&&(i=e[u]===s[u]);return i?e:s}function he(e){let t=0;for(const r in e)t++;return t}var kr=e=>[].concat(...e);function so(e){return new RegExp("(^|:)//").test(e)}function ao(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function Fr(e){return e!=null}function uo(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var co=e=>e.replace(/\/$/,""),fo=e=>e.replace(/^\//,"");function lo(e,t){if(!e)return t;if(!t)return e;if(so(t))return t;const r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=co(e),t=fo(t),`${e}${r}${t}`}var Ir=(...e)=>fetch(...e),po=e=>e.status>=200&&e.status<=299,yo=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function Dr(e){if(!ne(e))return e;const t={...e};for(const[r,n]of Object.entries(t))n===void 0&&delete t[r];return t}function Y({baseUrl:e,prepareHeaders:t=h=>h,fetchFn:r=Ir,paramsSerializer:n,isJsonContentType:i=yo,jsonContentType:s="application/json",jsonReplacer:u,timeout:c,responseHandler:o,validateStatus:y,...l}={}){return typeof fetch>"u"&&r===Ir&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(a,d)=>{const{signal:g,getState:v,extra:_,endpoint:b,forced:m,type:f}=d;let p,{url:S,headers:R=new Headers(l.headers),params:C=void 0,responseHandler:w=o??"json",validateStatus:T=y??po,timeout:O=c,...E}=typeof a=="string"?{url:a}:a,P={...l,signal:g,...E};R=new Headers(Dr(R)),P.headers=await t(R,{getState:v,extra:_,endpoint:b,forced:m,type:f})||R;const k=L=>typeof L=="object"&&(ne(L)||Array.isArray(L)||typeof L.toJSON=="function");if(!P.headers.has("content-type")&&k(P.body)&&P.headers.set("content-type",s),k(P.body)&&i(P.headers)&&(P.body=JSON.stringify(P.body,u)),C){const L=~S.indexOf("?")?"&":"?",x=n?n(C):new URLSearchParams(Dr(C));S+=L+x}S=lo(e,S);const F=new Request(S,P);p={request:new Request(S,P)};let U,W=!1,N=O&&setTimeout(()=>{W=!0,d.abort()},O);try{U=await r(F)}catch(L){return{error:{status:W?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(L)},meta:p}}finally{N&&clearTimeout(N)}const Q=U.clone();p.response=Q;let $,B="";try{let L;if(await Promise.all([h(U,w).then(x=>$=x,x=>L=x),Q.text().then(x=>B=x,()=>{})]),L)throw L}catch(L){return{error:{status:"PARSING_ERROR",originalStatus:U.status,data:B,error:String(L)},meta:p}}return T(U,$)?{data:$,meta:p}:{error:{status:U.status,data:$},meta:p}};async function h(a,d){if(typeof d=="function")return d(a);if(d==="content-type"&&(d=i(a.headers)?"json":"text"),d==="json"){const g=await a.text();return g.length?JSON.parse(g):null}return a.text()}}var $r=class{constructor(e,t=void 0){this.value=e,this.meta=t}},kt=A("__rtkq/focused"),qr=A("__rtkq/unfocused"),Ft=A("__rtkq/online"),Nr=A("__rtkq/offline");function Ur(e){return e.type==="query"}function ho(e){return e.type==="mutation"}function It(e,t,r,n,i,s){return go(e)?e(t,r,n,i).map(Dt).map(s):Array.isArray(e)?e.map(Dt).map(s):[]}function go(e){return typeof e=="function"}function Dt(e){return typeof e=="string"?{type:e}:e}function mo(e,t){return e.catch(t)}var Ie=Symbol("forceQueryFn"),$t=e=>typeof e[Ie]=="function";function _o({serializeQueryArgs:e,queryThunk:t,mutationThunk:r,api:n,context:i}){const s=new Map,u=new Map,{unsubscribeQueryResult:c,removeMutationResult:o,updateSubscriptionOptions:y}=n.internalActions;return{buildInitiateQuery:g,buildInitiateMutation:v,getRunningQueryThunk:l,getRunningMutationThunk:h,getRunningQueriesThunk:a,getRunningMutationsThunk:d};function l(_,b){return m=>{var S;const f=i.endpointDefinitions[_],p=e({queryArgs:b,endpointDefinition:f,endpointName:_});return(S=s.get(m))==null?void 0:S[p]}}function h(_,b){return m=>{var f;return(f=u.get(m))==null?void 0:f[b]}}function a(){return _=>Object.values(s.get(_)||{}).filter(Fr)}function d(){return _=>Object.values(u.get(_)||{}).filter(Fr)}function g(_,b){const m=(f,{subscribe:p=!0,forceRefetch:S,subscriptionOptions:R,[Ie]:C,...w}={})=>(T,O)=>{var L;const E=e({queryArgs:f,endpointDefinition:b,endpointName:_}),P=t({...w,type:"query",subscribe:p,forceRefetch:S,subscriptionOptions:R,endpointName:_,originalArgs:f,queryCacheKey:E,[Ie]:C}),k=n.endpoints[_].select(f),F=T(P),q=k(O()),{requestId:U,abort:W}=F,N=q.requestId!==U,Q=(L=s.get(T))==null?void 0:L[E],$=()=>k(O()),B=Object.assign(C?F.then($):N&&!Q?Promise.resolve(q):Promise.all([Q,F]).then($),{arg:f,requestId:U,subscriptionOptions:R,queryCacheKey:E,abort:W,async unwrap(){const x=await B;if(x.isError)throw x.error;return x.data},refetch:()=>T(m(f,{subscribe:!1,forceRefetch:!0})),unsubscribe(){p&&T(c({queryCacheKey:E,requestId:U}))},updateSubscriptionOptions(x){B.subscriptionOptions=x,T(y({endpointName:_,requestId:U,queryCacheKey:E,options:x}))}});if(!Q&&!N&&!C){const x=s.get(T)||{};x[E]=B,s.set(T,x),B.then(()=>{delete x[E],he(x)||s.delete(T)})}return B};return m}function v(_){return(b,{track:m=!0,fixedCacheKey:f}={})=>(p,S)=>{const R=r({type:"mutation",endpointName:_,originalArgs:b,track:m,fixedCacheKey:f}),C=p(R),{requestId:w,abort:T,unwrap:O}=C,E=mo(C.unwrap().then(q=>({data:q})),q=>({error:q})),P=()=>{p(o({requestId:w,fixedCacheKey:f}))},k=Object.assign(E,{arg:C.arg,requestId:w,abort:T,unwrap:O,reset:P}),F=u.get(p)||{};return u.set(p,F),F[w]=k,k.then(()=>{delete F[w],he(F)||u.delete(p)}),f&&(F[f]=k,k.then(()=>{F[f]===k&&(delete F[f],he(F)||u.delete(p))})),k}}}function Lr(e){return e}function vo({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:n,api:i,assertTagType:s}){const u=(m,f,p,S)=>(R,C)=>{const w=r[m],T=n({queryArgs:f,endpointDefinition:w,endpointName:m});if(R(i.internalActions.queryResultPatched({queryCacheKey:T,patches:p})),!S)return;const O=i.endpoints[m].select(f)(C()),E=It(w.providesTags,O.data,void 0,f,{},s);R(i.internalActions.updateProvidedBy({queryCacheKey:T,providedTags:E}))},c=(m,f,p,S=!0)=>(R,C)=>{const T=i.endpoints[m].select(f)(C()),O={patches:[],inversePatches:[],undo:()=>R(i.util.patchQueryData(m,f,O.inversePatches,S))};if(T.status==="uninitialized")return O;let E;if("data"in T)if(Z(T.data)){const[P,k,F]=fr(T.data,p);O.patches.push(...k),O.inversePatches.push(...F),E=P}else E=p(T.data),O.patches.push({op:"replace",path:[],value:E}),O.inversePatches.push({op:"replace",path:[],value:T.data});return O.patches.length===0||R(i.util.patchQueryData(m,f,O.patches,S)),O},o=(m,f,p)=>S=>S(i.endpoints[m].initiate(f,{subscribe:!1,forceRefetch:!0,[Ie]:()=>({data:p})})),y=async(m,{signal:f,abort:p,rejectWithValue:S,fulfillWithValue:R,dispatch:C,getState:w,extra:T})=>{const O=r[m.endpointName];try{let E=Lr,P;const k={signal:f,abort:p,dispatch:C,getState:w,extra:T,endpoint:m.endpointName,type:m.type,forced:m.type==="query"?l(m,w()):void 0},F=m.type==="query"?m[Ie]:void 0;if(F?P=F():O.query?(P=await t(O.query(m.originalArgs),k,O.extraOptions),O.transformResponse&&(E=O.transformResponse)):P=await O.queryFn(m.originalArgs,k,O.extraOptions,q=>t(q,k,O.extraOptions)),typeof process<"u",P.error)throw new $r(P.error,P.meta);return R(await E(P.data,P.meta,m.originalArgs),{fulfilledTimeStamp:Date.now(),baseQueryMeta:P.meta,[Ee]:!0})}catch(E){let P=E;if(P instanceof $r){let k=Lr;O.query&&O.transformErrorResponse&&(k=O.transformErrorResponse);try{return S(await k(P.value,P.meta,m.originalArgs),{baseQueryMeta:P.meta,[Ee]:!0})}catch(F){P=F}}throw typeof process<"u",console.error(P),P}};function l(m,f){var w,T,O;const p=(T=(w=f[e])==null?void 0:w.queries)==null?void 0:T[m.queryCacheKey],S=(O=f[e])==null?void 0:O.config.refetchOnMountOrArgChange,R=p==null?void 0:p.fulfilledTimeStamp,C=m.forceRefetch??(m.subscribe&&S);return C?C===!0||(Number(new Date)-Number(R))/1e3>=C:!1}const h=Ye(`${e}/executeQuery`,y,{getPendingMeta(){return{startedTimeStamp:Date.now(),[Ee]:!0}},condition(m,{getState:f}){var O,E,P;const p=f(),S=(E=(O=p[e])==null?void 0:O.queries)==null?void 0:E[m.queryCacheKey],R=S==null?void 0:S.fulfilledTimeStamp,C=m.originalArgs,w=S==null?void 0:S.originalArgs,T=r[m.endpointName];return $t(m)?!0:(S==null?void 0:S.status)==="pending"?!1:l(m,p)||Ur(T)&&((P=T==null?void 0:T.forceRefetch)!=null&&P.call(T,{currentArg:C,previousArg:w,endpointState:S,state:p}))?!0:!R},dispatchConditionRejection:!0}),a=Ye(`${e}/executeMutation`,y,{getPendingMeta(){return{startedTimeStamp:Date.now(),[Ee]:!0}}}),d=m=>"force"in m,g=m=>"ifOlderThan"in m,v=(m,f,p)=>(S,R)=>{const C=d(p)&&p.force,w=g(p)&&p.ifOlderThan,T=(E=!0)=>{const P={forceRefetch:E,isPrefetch:!0};return i.endpoints[m].initiate(f,P)},O=i.endpoints[m].select(f)(R());if(C)S(T());else if(w){const E=O==null?void 0:O.fulfilledTimeStamp;if(!E){S(T());return}(Number(new Date)-Number(new Date(E)))/1e3>=w&&S(T())}else S(T(!1))};function _(m){return f=>{var p,S;return((S=(p=f==null?void 0:f.meta)==null?void 0:p.arg)==null?void 0:S.endpointName)===m}}function b(m,f){return{matchPending:Me(Tt(m),_(f)),matchFulfilled:Me(ie(m),_(f)),matchRejected:Me(ye(m),_(f))}}return{queryThunk:h,mutationThunk:a,prefetch:v,updateQueryData:c,upsertQueryData:o,patchQueryData:u,buildMatchThunkActions:b}}function xr(e,t,r,n){return It(r[e.meta.arg.endpointName][t],ie(e)?e.payload:void 0,Je(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,n)}function tt(e,t,r){const n=e[t];n&&r(n)}function De(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function zr(e,t,r){const n=e[De(t)];n&&r(n)}var $e={};function So({reducerPath:e,queryThunk:t,mutationThunk:r,context:{endpointDefinitions:n,apiUid:i,extractRehydrationInfo:s,hasRehydrationInfo:u},assertTagType:c,config:o}){const y=A(`${e}/resetApiState`),l=fe({name:`${e}/queries`,initialState:$e,reducers:{removeQueryResult:{reducer(f,{payload:{queryCacheKey:p}}){delete f[p]},prepare:Ae()},queryResultPatched:{reducer(f,{payload:{queryCacheKey:p,patches:S}}){tt(f,p,R=>{R.data=lr(R.data,S.concat())})},prepare:Ae()}},extraReducers(f){f.addCase(t.pending,(p,{meta:S,meta:{arg:R}})=>{var w;const C=$t(R);p[w=R.queryCacheKey]??(p[w]={status:"uninitialized",endpointName:R.endpointName}),tt(p,R.queryCacheKey,T=>{T.status="pending",T.requestId=C&&T.requestId?T.requestId:S.requestId,R.originalArgs!==void 0&&(T.originalArgs=R.originalArgs),T.startedTimeStamp=S.startedTimeStamp})}).addCase(t.fulfilled,(p,{meta:S,payload:R})=>{tt(p,S.arg.queryCacheKey,C=>{if(C.requestId!==S.requestId&&!$t(S.arg))return;const{merge:w}=n[S.arg.endpointName];if(C.status="fulfilled",w)if(C.data!==void 0){const{fulfilledTimeStamp:T,arg:O,baseQueryMeta:E,requestId:P}=S;let k=Oe(C.data,F=>w(F,R,{arg:O.originalArgs,baseQueryMeta:E,fulfilledTimeStamp:T,requestId:P}));C.data=k}else C.data=R;else C.data=n[S.arg.endpointName].structuralSharing??!0?Mr(j(C.data)?Kn(C.data):C.data,R):R;delete C.error,C.fulfilledTimeStamp=S.fulfilledTimeStamp})}).addCase(t.rejected,(p,{meta:{condition:S,arg:R,requestId:C},error:w,payload:T})=>{tt(p,R.queryCacheKey,O=>{if(!S){if(O.requestId!==C)return;O.status="rejected",O.error=T??w}})}).addMatcher(u,(p,S)=>{const{queries:R}=s(S);for(const[C,w]of Object.entries(R))((w==null?void 0:w.status)==="fulfilled"||(w==null?void 0:w.status)==="rejected")&&(p[C]=w)})}}),h=fe({name:`${e}/mutations`,initialState:$e,reducers:{removeMutationResult:{reducer(f,{payload:p}){const S=De(p);S in f&&delete f[S]},prepare:Ae()}},extraReducers(f){f.addCase(r.pending,(p,{meta:S,meta:{requestId:R,arg:C,startedTimeStamp:w}})=>{C.track&&(p[De(S)]={requestId:R,status:"pending",endpointName:C.endpointName,startedTimeStamp:w})}).addCase(r.fulfilled,(p,{payload:S,meta:R})=>{R.arg.track&&zr(p,R,C=>{C.requestId===R.requestId&&(C.status="fulfilled",C.data=S,C.fulfilledTimeStamp=R.fulfilledTimeStamp)})}).addCase(r.rejected,(p,{payload:S,error:R,meta:C})=>{C.arg.track&&zr(p,C,w=>{w.requestId===C.requestId&&(w.status="rejected",w.error=S??R)})}).addMatcher(u,(p,S)=>{const{mutations:R}=s(S);for(const[C,w]of Object.entries(R))((w==null?void 0:w.status)==="fulfilled"||(w==null?void 0:w.status)==="rejected")&&C!==(w==null?void 0:w.requestId)&&(p[C]=w)})}}),a=fe({name:`${e}/invalidation`,initialState:$e,reducers:{updateProvidedBy:{reducer(f,p){var C,w;const{queryCacheKey:S,providedTags:R}=p.payload;for(const T of Object.values(f))for(const O of Object.values(T)){const E=O.indexOf(S);E!==-1&&O.splice(E,1)}for(const{type:T,id:O}of R){const E=(C=f[T]??(f[T]={}))[w=O||"__internal_without_id"]??(C[w]=[]);E.includes(S)||E.push(S)}},prepare:Ae()}},extraReducers(f){f.addCase(l.actions.removeQueryResult,(p,{payload:{queryCacheKey:S}})=>{for(const R of Object.values(p))for(const C of Object.values(R)){const w=C.indexOf(S);w!==-1&&C.splice(w,1)}}).addMatcher(u,(p,S)=>{var C,w;const{provided:R}=s(S);for(const[T,O]of Object.entries(R))for(const[E,P]of Object.entries(O)){const k=(C=p[T]??(p[T]={}))[w=E||"__internal_without_id"]??(C[w]=[]);for(const F of P)k.includes(F)||k.push(F)}}).addMatcher(te(ie(t),Je(t)),(p,S)=>{const R=xr(S,"providesTags",n,c),{queryCacheKey:C}=S.meta.arg;a.caseReducers.updateProvidedBy(p,a.actions.updateProvidedBy({queryCacheKey:C,providedTags:R}))})}}),d=fe({name:`${e}/subscriptions`,initialState:$e,reducers:{updateSubscriptionOptions(f,p){},unsubscribeQueryResult(f,p){},internal_getRTKQSubscriptions(){}}}),g=fe({name:`${e}/internalSubscriptions`,initialState:$e,reducers:{subscriptionsUpdated:{reducer(f,p){return lr(f,p.payload)},prepare:Ae()}}}),v=fe({name:`${e}/config`,initialState:{online:uo(),focused:ao(),middlewareRegistered:!1,...o},reducers:{middlewareRegistered(f,{payload:p}){f.middlewareRegistered=f.middlewareRegistered==="conflict"||i!==p?"conflict":!0}},extraReducers:f=>{f.addCase(Ft,p=>{p.online=!0}).addCase(Nr,p=>{p.online=!1}).addCase(kt,p=>{p.focused=!0}).addCase(qr,p=>{p.focused=!1}).addMatcher(u,p=>({...p}))}}),_=zn({queries:l.reducer,mutations:h.reducer,provided:a.reducer,subscriptions:g.reducer,config:v.reducer}),b=(f,p)=>_(y.match(p)?void 0:f,p),m={...v.actions,...l.actions,...d.actions,...g.actions,...h.actions,...a.actions,resetApiState:y};return{reducer:b,actions:m}}var le=Symbol.for("RTKQ/skipToken"),Qr={status:"uninitialized"},Kr=Oe(Qr,()=>{}),Wr=Oe(Qr,()=>{});function bo({serializeQueryArgs:e,reducerPath:t,createSelector:r}){const n=h=>Kr,i=h=>Wr;return{buildQuerySelector:c,buildMutationSelector:o,selectInvalidatedBy:y,selectCachedArgsForQuery:l};function s(h){return{...h,...oo(h.status)}}function u(h){return h[t]}function c(h,a){return d=>{const g=e({queryArgs:d,endpointDefinition:a,endpointName:h});return r(d===le?n:b=>{var m,f;return((f=(m=u(b))==null?void 0:m.queries)==null?void 0:f[g])??Kr},s)}}function o(){return h=>{let a;return typeof h=="object"?a=De(h)??le:a=h,r(a===le?i:v=>{var _,b;return((b=(_=u(v))==null?void 0:_.mutations)==null?void 0:b[a])??Wr},s)}}function y(h,a){const d=h[t],g=new Set;for(const v of a.map(Dt)){const _=d.provided[v.type];if(!_)continue;let b=(v.id!==void 0?_[v.id]:kr(Object.values(_)))??[];for(const m of b)g.add(m)}return kr(Array.from(g.values()).map(v=>{const _=d.queries[v];return _?[{queryCacheKey:v,endpointName:_.endpointName,originalArgs:_.originalArgs}]:[]}))}function l(h,a){return Object.values(h[t].queries).filter(d=>(d==null?void 0:d.endpointName)===a&&d.status!=="uninitialized").map(d=>d.originalArgs)}}var ge=WeakMap?new WeakMap:void 0,Br=({endpointName:e,queryArgs:t})=>{let r="";const n=ge==null?void 0:ge.get(t);if(typeof n=="string")r=n;else{const i=JSON.stringify(t,(s,u)=>(u=typeof u=="bigint"?{$bigint:u.toString()}:u,u=ne(u)?Object.keys(u).sort().reduce((c,o)=>(c[o]=u[o],c),{}):u,u));ne(t)&&(ge==null||ge.set(t,i)),r=i}return`${e}(${r})`};function Co(...e){return function(r){const n=Ve(y=>{var l;return(l=r.extractRehydrationInfo)==null?void 0:l.call(r,y,{reducerPath:r.reducerPath??"api"})}),i={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:n,serializeQueryArgs(y){let l=Br;if("serializeQueryArgs"in y.endpointDefinition){const h=y.endpointDefinition.serializeQueryArgs;l=a=>{const d=h(a);return typeof d=="string"?d:Br({...a,queryArgs:d})}}else r.serializeQueryArgs&&(l=r.serializeQueryArgs);return l(y)},tagTypes:[...r.tagTypes||[]]},s={endpointDefinitions:{},batch(y){y()},apiUid:_r(),extractRehydrationInfo:n,hasRehydrationInfo:Ve(y=>n(y)!=null)},u={injectEndpoints:o,enhanceEndpoints({addTagTypes:y,endpoints:l}){if(y)for(const h of y)i.tagTypes.includes(h)||i.tagTypes.push(h);if(l)for(const[h,a]of Object.entries(l))typeof a=="function"?a(s.endpointDefinitions[h]):Object.assign(s.endpointDefinitions[h]||{},a);return u}},c=e.map(y=>y.init(u,i,s));function o(y){const l=y.endpoints({query:h=>({...h,type:"query"}),mutation:h=>({...h,type:"mutation"})});for(const[h,a]of Object.entries(l)){if(y.overrideExisting!==!0&&h in s.endpointDefinitions){if(y.overrideExisting==="throw")throw new Error(J(39));typeof process<"u";continue}s.endpointDefinitions[h]=a;for(const d of c)d.injectEndpoint(h,a)}return u}return u.injectEndpoints({endpoints:r.endpoints})}}function oe(e,...t){return Object.assign(e,...t)}var Ro=({api:e,queryThunk:t,internalState:r})=>{const n=`${e.reducerPath}/subscriptions`;let i=null,s=null;const{updateSubscriptionOptions:u,unsubscribeQueryResult:c}=e.internalActions,o=(d,g)=>{var _,b,m;if(u.match(g)){const{queryCacheKey:f,requestId:p,options:S}=g.payload;return(_=d==null?void 0:d[f])!=null&&_[p]&&(d[f][p]=S),!0}if(c.match(g)){const{queryCacheKey:f,requestId:p}=g.payload;return d[f]&&delete d[f][p],!0}if(e.internalActions.removeQueryResult.match(g))return delete d[g.payload.queryCacheKey],!0;if(t.pending.match(g)){const{meta:{arg:f,requestId:p}}=g,S=d[b=f.queryCacheKey]??(d[b]={});return S[`${p}_running`]={},f.subscribe&&(S[p]=f.subscriptionOptions??S[p]??{}),!0}let v=!1;if(t.fulfilled.match(g)||t.rejected.match(g)){const f=d[g.meta.arg.queryCacheKey]||{},p=`${g.meta.requestId}_running`;v||(v=!!f[p]),delete f[p]}if(t.rejected.match(g)){const{meta:{condition:f,arg:p,requestId:S}}=g;if(f&&p.subscribe){const R=d[m=p.queryCacheKey]??(d[m]={});R[S]=p.subscriptionOptions??R[S]??{},v=!0}}return v},y=()=>r.currentSubscriptions,a={getSubscriptions:y,getSubscriptionCount:d=>{const v=y()[d]??{};return he(v)},isRequestSubscribed:(d,g)=>{var _;const v=y();return!!((_=v==null?void 0:v[d])!=null&&_[g])}};return(d,g)=>{if(i||(i=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(d))return i=r.currentSubscriptions={},s=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(d))return[!1,a];const v=o(r.currentSubscriptions,d);let _=!0;if(v){s||(s=setTimeout(()=>{const f=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,p]=fr(i,()=>f);g.next(e.internalActions.subscriptionsUpdated(p)),i=f,s=null},500));const b=typeof d.type=="string"&&!!d.type.startsWith(n),m=t.rejected.match(d)&&d.meta.condition&&!!d.meta.arg.subscribe;_=!b&&!m}return[_,!1]}};function wo(e){for(const t in e)return!1;return!0}var To=2147483647/1e3-1,Oo=({reducerPath:e,api:t,queryThunk:r,context:n,internalState:i})=>{const{removeQueryResult:s,unsubscribeQueryResult:u}=t.internalActions,c=te(u.match,r.fulfilled,r.rejected);function o(a){const d=i.currentSubscriptions[a];return!!d&&!wo(d)}const y={},l=(a,d,g)=>{var v;if(c(a)){const _=d.getState()[e],{queryCacheKey:b}=u.match(a)?a.payload:a.meta.arg;h(b,(v=_.queries[b])==null?void 0:v.endpointName,d,_.config)}if(t.util.resetApiState.match(a))for(const[_,b]of Object.entries(y))b&&clearTimeout(b),delete y[_];if(n.hasRehydrationInfo(a)){const _=d.getState()[e],{queries:b}=n.extractRehydrationInfo(a);for(const[m,f]of Object.entries(b))h(m,f==null?void 0:f.endpointName,d,_.config)}};function h(a,d,g,v){const _=n.endpointDefinitions[d],b=(_==null?void 0:_.keepUnusedDataFor)??v.keepUnusedDataFor;if(b===1/0)return;const m=Math.max(0,Math.min(b,To));if(!o(a)){const f=y[a];f&&clearTimeout(f),y[a]=setTimeout(()=>{o(a)||g.dispatch(s({queryCacheKey:a})),delete y[a]},m*1e3)}}return l},Hr=new Error("Promise never resolved before cacheEntryRemoved."),Eo=({api:e,reducerPath:t,context:r,queryThunk:n,mutationThunk:i,internalState:s})=>{const u=Ot(n),c=Ot(i),o=ie(n,i),y={},l=(d,g,v)=>{const _=h(d);if(n.pending.match(d)){const b=v[t].queries[_],m=g.getState()[t].queries[_];!b&&m&&a(d.meta.arg.endpointName,d.meta.arg.originalArgs,_,g,d.meta.requestId)}else if(i.pending.match(d))g.getState()[t].mutations[_]&&a(d.meta.arg.endpointName,d.meta.arg.originalArgs,_,g,d.meta.requestId);else if(o(d)){const b=y[_];b!=null&&b.valueResolved&&(b.valueResolved({data:d.payload,meta:d.meta.baseQueryMeta}),delete b.valueResolved)}else if(e.internalActions.removeQueryResult.match(d)||e.internalActions.removeMutationResult.match(d)){const b=y[_];b&&(delete y[_],b.cacheEntryRemoved())}else if(e.util.resetApiState.match(d))for(const[b,m]of Object.entries(y))delete y[b],m.cacheEntryRemoved()};function h(d){return u(d)?d.meta.arg.queryCacheKey:c(d)?d.meta.arg.fixedCacheKey??d.meta.requestId:e.internalActions.removeQueryResult.match(d)?d.payload.queryCacheKey:e.internalActions.removeMutationResult.match(d)?De(d.payload):""}function a(d,g,v,_,b){const m=r.endpointDefinitions[d],f=m==null?void 0:m.onCacheEntryAdded;if(!f)return;const p={},S=new Promise(E=>{p.cacheEntryRemoved=E}),R=Promise.race([new Promise(E=>{p.valueResolved=E}),S.then(()=>{throw Hr})]);R.catch(()=>{}),y[v]=p;const C=e.endpoints[d].select(m.type==="query"?g:v),w=_.dispatch((E,P,k)=>k),T={..._,getCacheEntry:()=>C(_.getState()),requestId:b,extra:w,updateCachedData:m.type==="query"?E=>_.dispatch(e.util.updateQueryData(d,g,E)):void 0,cacheDataLoaded:R,cacheEntryRemoved:S},O=f(g,T);Promise.resolve(O).catch(E=>{if(E!==Hr)throw E})}return l},Ao=({api:e,context:{apiUid:t},reducerPath:r})=>(n,i)=>{e.util.resetApiState.match(n)&&i.dispatch(e.internalActions.middlewareRegistered(t)),typeof process<"u"},Po=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:n,queryThunk:i,api:s,assertTagType:u,refetchQuery:c,internalState:o})=>{const{removeQueryResult:y}=s.internalActions,l=te(ie(n),Je(n)),h=te(ie(n,i),ye(n,i));let a=[];const d=(_,b)=>{l(_)?v(xr(_,"invalidatesTags",r,u),b):h(_)?v([],b):s.util.invalidateTags.match(_)&&v(It(_.payload,void 0,void 0,void 0,void 0,u),b)};function g(_){var b,m;for(const f in _.queries)if(((b=_.queries[f])==null?void 0:b.status)==="pending")return!0;for(const f in _.mutations)if(((m=_.mutations[f])==null?void 0:m.status)==="pending")return!0;return!1}function v(_,b){const m=b.getState(),f=m[e];if(a.push(..._),f.config.invalidationBehavior==="delayed"&&g(f))return;const p=a;if(a=[],p.length===0)return;const S=s.util.selectInvalidatedBy(m,p);t.batch(()=>{const R=Array.from(S.values());for(const{queryCacheKey:C}of R){const w=f.queries[C],T=o.currentSubscriptions[C]??{};w&&(he(T)===0?b.dispatch(y({queryCacheKey:C})):w.status!=="uninitialized"&&b.dispatch(c(w,C)))}})}return d},Mo=({reducerPath:e,queryThunk:t,api:r,refetchQuery:n,internalState:i})=>{const s={},u=(a,d)=>{(r.internalActions.updateSubscriptionOptions.match(a)||r.internalActions.unsubscribeQueryResult.match(a))&&o(a.payload,d),(t.pending.match(a)||t.rejected.match(a)&&a.meta.condition)&&o(a.meta.arg,d),(t.fulfilled.match(a)||t.rejected.match(a)&&!a.meta.condition)&&c(a.meta.arg,d),r.util.resetApiState.match(a)&&l()};function c({queryCacheKey:a},d){const g=d.getState()[e],v=g.queries[a],_=i.currentSubscriptions[a];if(!v||v.status==="uninitialized")return;const{lowestPollingInterval:b,skipPollingIfUnfocused:m}=h(_);if(!Number.isFinite(b))return;const f=s[a];f!=null&&f.timeout&&(clearTimeout(f.timeout),f.timeout=void 0);const p=Date.now()+b;s[a]={nextPollTimestamp:p,pollingInterval:b,timeout:setTimeout(()=>{(g.config.focused||!m)&&d.dispatch(n(v,a)),c({queryCacheKey:a},d)},b)}}function o({queryCacheKey:a},d){const v=d.getState()[e].queries[a],_=i.currentSubscriptions[a];if(!v||v.status==="uninitialized")return;const{lowestPollingInterval:b}=h(_);if(!Number.isFinite(b)){y(a);return}const m=s[a],f=Date.now()+b;(!m||f<m.nextPollTimestamp)&&c({queryCacheKey:a},d)}function y(a){const d=s[a];d!=null&&d.timeout&&clearTimeout(d.timeout),delete s[a]}function l(){for(const a of Object.keys(s))y(a)}function h(a={}){let d=!1,g=Number.POSITIVE_INFINITY;for(let v in a)a[v].pollingInterval&&(g=Math.min(a[v].pollingInterval,g),d=a[v].skipPollingIfUnfocused||d);return{lowestPollingInterval:g,skipPollingIfUnfocused:d}}return u},ko=({api:e,context:t,queryThunk:r,mutationThunk:n})=>{const i=Tt(r,n),s=ye(r,n),u=ie(r,n),c={};return(y,l)=>{var h,a;if(i(y)){const{requestId:d,arg:{endpointName:g,originalArgs:v}}=y.meta,_=t.endpointDefinitions[g],b=_==null?void 0:_.onQueryStarted;if(b){const m={},f=new Promise((C,w)=>{m.resolve=C,m.reject=w});f.catch(()=>{}),c[d]=m;const p=e.endpoints[g].select(_.type==="query"?v:d),S=l.dispatch((C,w,T)=>T),R={...l,getCacheEntry:()=>p(l.getState()),requestId:d,extra:S,updateCachedData:_.type==="query"?C=>l.dispatch(e.util.updateQueryData(g,v,C)):void 0,queryFulfilled:f};b(v,R)}}else if(u(y)){const{requestId:d,baseQueryMeta:g}=y.meta;(h=c[d])==null||h.resolve({data:y.payload,meta:g}),delete c[d]}else if(s(y)){const{requestId:d,rejectedWithValue:g,baseQueryMeta:v}=y.meta;(a=c[d])==null||a.reject({error:y.payload??y.error,isUnhandledError:!g,meta:v}),delete c[d]}}},Fo=({reducerPath:e,context:t,api:r,refetchQuery:n,internalState:i})=>{const{removeQueryResult:s}=r.internalActions,u=(o,y)=>{kt.match(o)&&c(y,"refetchOnFocus"),Ft.match(o)&&c(y,"refetchOnReconnect")};function c(o,y){const l=o.getState()[e],h=l.queries,a=i.currentSubscriptions;t.batch(()=>{for(const d of Object.keys(a)){const g=h[d],v=a[d];if(!v||!g)continue;(Object.values(v).some(b=>b[y]===!0)||Object.values(v).every(b=>b[y]===void 0)&&l.config[y])&&(he(v)===0?o.dispatch(s({queryCacheKey:d})):g.status!=="uninitialized"&&o.dispatch(n(g,d)))}})}return u};function Io(e){const{reducerPath:t,queryThunk:r,api:n,context:i}=e,{apiUid:s}=i,u={invalidateTags:A(`${t}/invalidateTags`)},c=h=>h.type.startsWith(`${t}/`),o=[Ao,Oo,Po,Mo,Eo,ko];return{middleware:h=>{let a=!1;const g={...e,internalState:{currentSubscriptions:{}},refetchQuery:l,isThisApiSliceAction:c},v=o.map(m=>m(g)),_=Ro(g),b=Fo(g);return m=>f=>{if(!er(f))return m(f);a||(a=!0,h.dispatch(n.internalActions.middlewareRegistered(s)));const p={...h,next:m},S=h.getState(),[R,C]=_(f,p,S);let w;if(R?w=m(f):w=C,h.getState()[t]&&(b(f,p,S),c(f)||i.hasRehydrationInfo(f)))for(const T of v)T(f,p,S);return w}},actions:u};function l(h,a,d={}){return r({type:"query",endpointName:h.endpointName,originalArgs:h.originalArgs,subscribe:!1,forceRefetch:!0,queryCacheKey:a,...d})}}var Vr=Symbol(),Do=({createSelector:e=pe}={})=>({name:Vr,init(t,{baseQuery:r,tagTypes:n,reducerPath:i,serializeQueryArgs:s,keepUnusedDataFor:u,refetchOnMountOrArgChange:c,refetchOnFocus:o,refetchOnReconnect:y,invalidationBehavior:l},h){jn();const a=N=>(typeof process<"u",N);Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Ft,onOffline:Nr,onFocus:kt,onFocusLost:qr},util:{}});const{queryThunk:d,mutationThunk:g,patchQueryData:v,updateQueryData:_,upsertQueryData:b,prefetch:m,buildMatchThunkActions:f}=vo({baseQuery:r,reducerPath:i,context:h,api:t,serializeQueryArgs:s,assertTagType:a}),{reducer:p,actions:S}=So({context:h,queryThunk:d,mutationThunk:g,reducerPath:i,assertTagType:a,config:{refetchOnFocus:o,refetchOnReconnect:y,refetchOnMountOrArgChange:c,keepUnusedDataFor:u,reducerPath:i,invalidationBehavior:l}});oe(t.util,{patchQueryData:v,updateQueryData:_,upsertQueryData:b,prefetch:m,resetApiState:S.resetApiState}),oe(t.internalActions,S);const{middleware:R,actions:C}=Io({reducerPath:i,context:h,queryThunk:d,mutationThunk:g,api:t,assertTagType:a});oe(t.util,C),oe(t,{reducer:p,middleware:R});const{buildQuerySelector:w,buildMutationSelector:T,selectInvalidatedBy:O,selectCachedArgsForQuery:E}=bo({serializeQueryArgs:s,reducerPath:i,createSelector:e});oe(t.util,{selectInvalidatedBy:O,selectCachedArgsForQuery:E});const{buildInitiateQuery:P,buildInitiateMutation:k,getRunningMutationThunk:F,getRunningMutationsThunk:q,getRunningQueriesThunk:U,getRunningQueryThunk:W}=_o({queryThunk:d,mutationThunk:g,api:t,serializeQueryArgs:s,context:h});return oe(t.util,{getRunningMutationThunk:F,getRunningMutationsThunk:q,getRunningQueryThunk:W,getRunningQueriesThunk:U}),{name:Vr,injectEndpoint(N,Q){var B;const $=t;(B=$.endpoints)[N]??(B[N]={}),Ur(Q)?oe($.endpoints[N],{name:N,select:w(N,Q),initiate:P(N,Q)},f(d,N)):ho(Q)&&oe($.endpoints[N],{name:N,select:T(),initiate:k(N)},f(g,N))}}}});function Gr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jr={exports:{}},D={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qe=Symbol.for("react.element"),$o=Symbol.for("react.portal"),qo=Symbol.for("react.fragment"),No=Symbol.for("react.strict_mode"),Uo=Symbol.for("react.profiler"),Lo=Symbol.for("react.provider"),xo=Symbol.for("react.context"),zo=Symbol.for("react.forward_ref"),Qo=Symbol.for("react.suspense"),Ko=Symbol.for("react.memo"),Wo=Symbol.for("react.lazy"),Yr=Symbol.iterator;function Bo(e){return e===null||typeof e!="object"?null:(e=Yr&&e[Yr]||e["@@iterator"],typeof e=="function"?e:null)}var Xr={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zr=Object.assign,jr={};function me(e,t,r){this.props=e,this.context=t,this.refs=jr,this.updater=r||Xr}me.prototype.isReactComponent={},me.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},me.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function en(){}en.prototype=me.prototype;function qt(e,t,r){this.props=e,this.context=t,this.refs=jr,this.updater=r||Xr}var Nt=qt.prototype=new en;Nt.constructor=qt,Zr(Nt,me.prototype),Nt.isPureReactComponent=!0;var tn=Array.isArray,rn=Object.prototype.hasOwnProperty,Ut={current:null},nn={key:!0,ref:!0,__self:!0,__source:!0};function on(e,t,r){var n,i={},s=null,u=null;if(t!=null)for(n in t.ref!==void 0&&(u=t.ref),t.key!==void 0&&(s=""+t.key),t)rn.call(t,n)&&!nn.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var o=Array(c),y=0;y<c;y++)o[y]=arguments[y+2];i.children=o}if(e&&e.defaultProps)for(n in c=e.defaultProps,c)i[n]===void 0&&(i[n]=c[n]);return{$$typeof:qe,type:e,key:s,ref:u,props:i,_owner:Ut.current}}function Ho(e,t){return{$$typeof:qe,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lt(e){return typeof e=="object"&&e!==null&&e.$$typeof===qe}function Vo(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var sn=/\/+/g;function xt(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Vo(""+e.key):t.toString(36)}function rt(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var u=!1;if(e===null)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case qe:case $o:u=!0}}if(u)return u=e,i=i(u),e=n===""?"."+xt(u,0):n,tn(i)?(r="",e!=null&&(r=e.replace(sn,"$&/")+"/"),rt(i,t,r,"",function(y){return y})):i!=null&&(Lt(i)&&(i=Ho(i,r+(!i.key||u&&u.key===i.key?"":(""+i.key).replace(sn,"$&/")+"/")+e)),t.push(i)),1;if(u=0,n=n===""?".":n+":",tn(e))for(var c=0;c<e.length;c++){s=e[c];var o=n+xt(s,c);u+=rt(s,t,r,o,i)}else if(o=Bo(e),typeof o=="function")for(e=o.call(e),c=0;!(s=e.next()).done;)s=s.value,o=n+xt(s,c++),u+=rt(s,t,r,o,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function nt(e,t,r){if(e==null)return e;var n=[],i=0;return rt(e,n,"","",function(s){return t.call(r,s,i++)}),n}function Go(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var K={current:null},it={transition:null},Jo={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:it,ReactCurrentOwner:Ut};D.Children={map:nt,forEach:function(e,t,r){nt(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nt(e,function(){t++}),t},toArray:function(e){return nt(e,function(t){return t})||[]},only:function(e){if(!Lt(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},D.Component=me,D.Fragment=qo,D.Profiler=Uo,D.PureComponent=qt,D.StrictMode=No,D.Suspense=Qo,D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jo,D.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Zr({},e.props),i=e.key,s=e.ref,u=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,u=Ut.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(o in t)rn.call(t,o)&&!nn.hasOwnProperty(o)&&(n[o]=t[o]===void 0&&c!==void 0?c[o]:t[o])}var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){c=Array(o);for(var y=0;y<o;y++)c[y]=arguments[y+2];n.children=c}return{$$typeof:qe,type:e.type,key:i,ref:s,props:n,_owner:u}},D.createContext=function(e){return e={$$typeof:xo,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lo,_context:e},e.Consumer=e},D.createElement=on,D.createFactory=function(e){var t=on.bind(null,e);return t.type=e,t},D.createRef=function(){return{current:null}},D.forwardRef=function(e){return{$$typeof:zo,render:e}},D.isValidElement=Lt,D.lazy=function(e){return{$$typeof:Wo,_payload:{_status:-1,_result:e},_init:Go}},D.memo=function(e,t){return{$$typeof:Ko,type:e,compare:t===void 0?null:t}},D.startTransition=function(e){var t=it.transition;it.transition={};try{e()}finally{it.transition=t}},D.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},D.useCallback=function(e,t){return K.current.useCallback(e,t)},D.useContext=function(e){return K.current.useContext(e)},D.useDebugValue=function(){},D.useDeferredValue=function(e){return K.current.useDeferredValue(e)},D.useEffect=function(e,t){return K.current.useEffect(e,t)},D.useId=function(){return K.current.useId()},D.useImperativeHandle=function(e,t,r){return K.current.useImperativeHandle(e,t,r)},D.useInsertionEffect=function(e,t){return K.current.useInsertionEffect(e,t)},D.useLayoutEffect=function(e,t){return K.current.useLayoutEffect(e,t)},D.useMemo=function(e,t){return K.current.useMemo(e,t)},D.useReducer=function(e,t,r){return K.current.useReducer(e,t,r)},D.useRef=function(e){return K.current.useRef(e)},D.useState=function(e){return K.current.useState(e)},D.useSyncExternalStore=function(e,t,r){return K.current.useSyncExternalStore(e,t,r)},D.useTransition=function(){return K.current.useTransition()},D.version="18.2.0",Jr.exports=D;var I=Jr.exports;const an=Gr(I),un=V({__proto__:null,default:an},[I]);var cn={exports:{}},fn={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne=I;function Yo(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xo=typeof Object.is=="function"?Object.is:Yo,Zo=Ne.useSyncExternalStore,jo=Ne.useRef,es=Ne.useEffect,ts=Ne.useMemo,rs=Ne.useDebugValue;fn.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=jo(null);if(s.current===null){var u={hasValue:!1,value:null};s.current=u}else u=s.current;s=ts(function(){function o(d){if(!y){if(y=!0,l=d,d=n(d),i!==void 0&&u.hasValue){var g=u.value;if(i(g,d))return h=g}return h=d}if(g=h,Xo(l,d))return g;var v=n(d);return i!==void 0&&i(g,v)?g:(l=d,h=v)}var y=!1,l,h,a=r===void 0?null:r;return[function(){return o(t())},a===null?void 0:function(){return o(a())}]},[t,r,n,i]);var c=Zo(e,s[0],s[1]);return es(function(){u.hasValue=!0,u.value=c},[c]),rs(c),c},cn.exports=fn;var ns=cn.exports,ee="default"in un?an:un,ln=Symbol.for("react-redux-context"),dn=typeof globalThis<"u"?globalThis:{};function is(){if(!ee.createContext)return{};const e=dn[ln]??(dn[ln]=new Map);let t=e.get(ee.createContext);return t||(t=ee.createContext(null),e.set(ee.createContext,t)),t}var de=is(),os=()=>{throw new Error("uSES not initialized!")};function zt(e=de){return function(){return ee.useContext(e)}}var pn=zt(),yn=os,ss=e=>{yn=e},as=(e,t)=>e===t;function us(e=de){const t=e===de?pn:zt(e),r=(n,i={})=>{const{equalityFn:s=as,devModeChecks:u={}}=typeof i=="function"?{equalityFn:i}:i,{store:c,subscription:o,getServerState:y,stabilityCheck:l,identityFunctionCheck:h}=t();ee.useRef(!0);const a=ee.useCallback({[n.name](g){return n(g)}}[n.name],[n,l,u.stabilityCheck]),d=yn(o.addNestedSub,c.getState,y||c.getState,a,s);return ee.useDebugValue(d),d};return Object.assign(r,{withTypes:()=>r}),r}var cs=us();function fs(e){e()}var ls=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ds=typeof navigator<"u"&&navigator.product==="ReactNative";ls||ds?ee.useLayoutEffect:ee.useEffect;function hn(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Ue(e,t){if(hn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!hn(e[r[i]],t[r[i]]))return!1;return!0}function gn(e=de){const t=e===de?pn:zt(e),r=()=>{const{store:n}=t();return n};return Object.assign(r,{withTypes:()=>r}),r}var mn=gn();function ps(e=de){const t=e===de?mn:gn(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var ys=ps(),hs=fs;ss(ns.useSyncExternalStoreWithSelector);function gs(e){return e.type==="query"}function ms(e){return e.type==="mutation"}function ot(e,...t){return Object.assign(e,...t)}function Qt(e){return e.replace(e[0],e[0].toUpperCase())}var _e=WeakMap?new WeakMap:void 0,_s=({endpointName:e,queryArgs:t})=>{let r="";const n=_e==null?void 0:_e.get(t);if(typeof n=="string")r=n;else{const i=JSON.stringify(t,(s,u)=>(u=typeof u=="bigint"?{$bigint:u.toString()}:u,u=ne(u)?Object.keys(u).sort().reduce((c,o)=>(c[o]=u[o],c),{}):u,u));ne(t)&&(_e==null||_e.set(t,i)),r=i}return`${e}(${r})`},Kt=Symbol();function _n(e,t,r,n){const i=I.useMemo(()=>({queryArgs:e,serialized:typeof e=="object"?t({queryArgs:e,endpointDefinition:r,endpointName:n}):e}),[e,t,r,n]),s=I.useRef(i);return I.useEffect(()=>{s.current.serialized!==i.serialized&&(s.current=i)},[i]),s.current.serialized===i.serialized?s.current.queryArgs:e}function Wt(e){const t=I.useRef(e);return I.useEffect(()=>{Ue(t.current,e)||(t.current=e)},[e]),Ue(t.current,e)?t.current:e}var vs=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ss=vs(),bs=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Cs=bs(),Rs=()=>Ss||Cs?I.useLayoutEffect:I.useEffect,ws=Rs(),Ts=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:Ar.pending}:e;function Os({api:e,moduleOptions:{batch:t,hooks:{useDispatch:r,useSelector:n,useStore:i},unstable__sideEffectsInRender:s,createSelector:u},serializeQueryArgs:c,context:o}){const y=s?g=>g():I.useEffect;return{buildQueryHooks:a,buildMutationHook:d,usePrefetch:h};function l(g,v,_){if(v!=null&&v.endpointName&&g.isUninitialized){const{endpointName:R}=v,C=o.endpointDefinitions[R];c({queryArgs:v.originalArgs,endpointDefinition:C,endpointName:R})===c({queryArgs:_,endpointDefinition:C,endpointName:R})&&(v=void 0)}let b=g.isSuccess?g.data:v==null?void 0:v.data;b===void 0&&(b=g.data);const m=b!==void 0,f=g.isLoading,p=(!v||v.isLoading||v.isUninitialized)&&!m&&f,S=g.isSuccess||f&&m;return{...g,data:b,currentData:g.data,isFetching:f,isLoading:p,isSuccess:S}}function h(g,v){const _=r(),b=Wt(v);return I.useCallback((m,f)=>_(e.util.prefetch(g,m,{...b,...f})),[g,_,b])}function a(g){const v=(m,{refetchOnReconnect:f,refetchOnFocus:p,refetchOnMountOrArgChange:S,skip:R=!1,pollingInterval:C=0,skipPollingIfUnfocused:w=!1}={})=>{const{initiate:T}=e.endpoints[g],O=r(),E=I.useRef(void 0);if(!E.current){const $=O(e.internalActions.internal_getRTKQSubscriptions());E.current=$}const P=_n(R?le:m,_s,o.endpointDefinitions[g],g),k=Wt({refetchOnReconnect:f,refetchOnFocus:p,pollingInterval:C,skipPollingIfUnfocused:w}),F=I.useRef(!1),q=I.useRef(void 0);let{queryCacheKey:U,requestId:W}=q.current||{},N=!1;U&&W&&(N=E.current.isRequestSubscribed(U,W));const Q=!N&&F.current;return y(()=>{F.current=N}),y(()=>{Q&&(q.current=void 0)},[Q]),y(()=>{var L;const $=q.current;if(typeof process<"u",P===le){$==null||$.unsubscribe(),q.current=void 0;return}const B=(L=q.current)==null?void 0:L.subscriptionOptions;if(!$||$.arg!==P){$==null||$.unsubscribe();const x=O(T(P,{subscriptionOptions:k,forceRefetch:S}));q.current=x}else k!==B&&$.updateSubscriptionOptions(k)},[O,T,S,P,k,Q]),I.useEffect(()=>()=>{var $;($=q.current)==null||$.unsubscribe(),q.current=void 0},[]),I.useMemo(()=>({refetch:()=>{var $;if(!q.current)throw new Error(J(38));return($=q.current)==null?void 0:$.refetch()}}),[])},_=({refetchOnReconnect:m,refetchOnFocus:f,pollingInterval:p=0,skipPollingIfUnfocused:S=!1}={})=>{const{initiate:R}=e.endpoints[g],C=r(),[w,T]=I.useState(Kt),O=I.useRef(void 0),E=Wt({refetchOnReconnect:m,refetchOnFocus:f,pollingInterval:p,skipPollingIfUnfocused:S});y(()=>{var q,U;const F=(q=O.current)==null?void 0:q.subscriptionOptions;E!==F&&((U=O.current)==null||U.updateSubscriptionOptions(E))},[E]);const P=I.useRef(E);y(()=>{P.current=E},[E]);const k=I.useCallback(function(F,q=!1){let U;return t(()=>{var W;(W=O.current)==null||W.unsubscribe(),O.current=U=C(R(F,{subscriptionOptions:P.current,forceRefetch:!q})),T(F)}),U},[C,R]);return I.useEffect(()=>()=>{var F;(F=O==null?void 0:O.current)==null||F.unsubscribe()},[]),I.useEffect(()=>{w!==Kt&&!O.current&&k(w,!0)},[w,k]),I.useMemo(()=>[k,w],[k,w])},b=(m,{skip:f=!1,selectFromResult:p}={})=>{const{select:S}=e.endpoints[g],R=_n(f?le:m,c,o.endpointDefinitions[g],g),C=I.useRef(void 0),w=I.useMemo(()=>u([S(R),(k,F)=>F,k=>R],l,{memoizeOptions:{resultEqualityCheck:Ue}}),[S,R]),T=I.useMemo(()=>p?u([w],p,{devModeChecks:{identityFunctionCheck:"never"}}):w,[w,p]),O=n(k=>T(k,C.current),Ue),E=i(),P=w(E.getState(),C.current);return ws(()=>{C.current=P},[P]),O};return{useQueryState:b,useQuerySubscription:v,useLazyQuerySubscription:_,useLazyQuery(m){const[f,p]=_(m),S=b(p,{...m,skip:p===Kt}),R=I.useMemo(()=>({lastArg:p}),[p]);return I.useMemo(()=>[f,S,R],[f,S,R])},useQuery(m,f){const p=v(m,f),S=b(m,{selectFromResult:m===le||f!=null&&f.skip?void 0:Ts,...f}),{data:R,status:C,isLoading:w,isSuccess:T,isError:O,error:E}=S;return I.useDebugValue({data:R,status:C,isLoading:w,isSuccess:T,isError:O,error:E}),I.useMemo(()=>({...S,...p}),[S,p])}}}function d(g){return({selectFromResult:v,fixedCacheKey:_}={})=>{const{select:b,initiate:m}=e.endpoints[g],f=r(),[p,S]=I.useState();I.useEffect(()=>()=>{p!=null&&p.arg.fixedCacheKey||p==null||p.reset()},[p]);const R=I.useCallback(function(B){const L=f(m(B,{fixedCacheKey:_}));return S(L),L},[f,m,_]),{requestId:C}=p||{},w=I.useMemo(()=>b({fixedCacheKey:_,requestId:p==null?void 0:p.requestId}),[_,p,b]),T=I.useMemo(()=>v?u([w],v):w,[v,w]),O=n(T,Ue),E=_==null?p==null?void 0:p.arg.originalArgs:void 0,P=I.useCallback(()=>{t(()=>{p&&S(void 0),_&&f(e.internalActions.removeMutationResult({requestId:C,fixedCacheKey:_}))})},[f,_,p,C]),{endpointName:k,data:F,status:q,isLoading:U,isSuccess:W,isError:N,error:Q}=O;I.useDebugValue({endpointName:k,data:F,status:q,isLoading:U,isSuccess:W,isError:N,error:Q});const $=I.useMemo(()=>({...O,originalArgs:E,reset:P}),[O,E,P]);return I.useMemo(()=>[R,$],[R,$])}}}var Es=Symbol(),As=({batch:e=hs,hooks:t={useDispatch:ys,useSelector:cs,useStore:mn},createSelector:r=pe,unstable__sideEffectsInRender:n=!1,...i}={})=>({name:Es,init(s,{serializeQueryArgs:u},c){const o=s,{buildQueryHooks:y,buildMutationHook:l,usePrefetch:h}=Os({api:s,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:n,createSelector:r},serializeQueryArgs:u,context:c});return ot(o,{usePrefetch:h}),ot(c,{batch:e}),{injectEndpoint(a,d){if(gs(d)){const{useQuery:g,useLazyQuery:v,useLazyQuerySubscription:_,useQueryState:b,useQuerySubscription:m}=y(a);ot(o.endpoints[a],{useQuery:g,useLazyQuery:v,useLazyQuerySubscription:_,useQueryState:b,useQuerySubscription:m}),s[`use${Qt(a)}Query`]=g,s[`useLazy${Qt(a)}Query`]=v}else if(ms(d)){const g=l(a);ot(o.endpoints[a],{useMutation:g}),s[`use${Qt(a)}Mutation`]=g}}}}}),X=Co(Do(),As());X({reducerPath:"caps",baseQuery:Y({prepareHeaders:(e,{getState:t})=>{const r=t().config.apiKey;return r&&e.set("Authorization",`Bearer ${r}`),e}}),endpoints:e=>({getCaps:e.query({queryFn:async(t,r,n,i)=>{const c=`http://127.0.0.1:${r.getState().config.lspPort}${Ni}`,o=await i({url:c,credentials:"same-origin",redirect:"follow"});return o.error?{error:o.error}:vn(o.data)?{data:o.data}:{meta:o.meta,error:{error:"Invalid response from caps",data:o.data,status:"CUSTOM_ERROR"}}}})}),refetchOnMountOrArgChange:!0}).endpoints;function vn(e){return!(!e||typeof e!="object"||!("code_chat_default_model"in e)||typeof e.code_chat_default_model!="string"||!("code_chat_models"in e))}const Ps=4096;function Ms(e){return!(!e||typeof e!="object"||!("role"in e)||typeof e.role!="string"||!("content"in e)||e.content!==null&&typeof e.content!="string")}async function ks({messages:e,model:t,abortSignal:r,stream:n,max_new_tokens:i,onlyDeterministicMessages:s,chatId:u,tools:c,port:o=8001,apiKey:y,toolsConfirmed:l=!0,checkpointsEnabled:h=!0,integration:a,last_user_message_id:d="",mode:g}){const v=JSON.stringify({messages:e,model:t,stream:n,tools:c,max_tokens:i,only_deterministic_messages:s,tools_confirmation:l,checkpoints_enabled:h,meta:{chat_id:u,request_attempt_id:d,chat_mode:g??"EXPLORE",...a!=null&&a.path?{current_config_file:a.path}:{}}}),_={"Content-Type":"application/json",...y?{Authorization:"Bearer "+y}:{}},b=`http://127.0.0.1:${o}${Tr}`;return fetch(b,{method:"POST",headers:_,body:v,redirect:"follow",cache:"no-cache",signal:r,credentials:"same-origin"})}async function Fs({messages:e,model:t,stream:r,onlyDeterministicMessages:n,chatId:i,port:s=8001,apiKey:u}){const c=JSON.stringify({messages:e,model:t,stream:r,max_tokens:300,only_deterministic_messages:n,chat_id:i}),o={"Content-Type":"application/json",...u?{Authorization:"Bearer "+u}:{}},y=`http://127.0.0.1:${s}${Tr}`;return fetch(y,{method:"POST",headers:o,body:c,redirect:"follow",cache:"no-cache",credentials:"same-origin"})}/*! js-cookie v3.0.5 | MIT */function st(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Is={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Bt(e,t){function r(i,s,u){if(!(typeof document>"u")){u=st({},t,u),typeof u.expires=="number"&&(u.expires=new Date(Date.now()+u.expires*864e5)),u.expires&&(u.expires=u.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var o in u)u[o]&&(c+="; "+o,u[o]!==!0&&(c+="="+u[o].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+c}}function n(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],u={},c=0;c<s.length;c++){var o=s[c].split("="),y=o.slice(1).join("=");try{var l=decodeURIComponent(o[0]);if(u[l]=e.read(y,l),i===l)break}catch{}}return i?u[i]:u}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",st({},s,{expires:-1}))},withAttributes:function(i){return Bt(this.converter,st({},this.attributes,i))},withConverter:function(i){return Bt(st({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}Bt(Is,{path:"/"});function at(e,t,r){try{const n=JSON.parse(e);return r&&!r(n)?t:n}catch{return t}}function Sn(e,t,r=[]){if(e.length===0)return r;const n=e.slice(-1)[0];if(!t(n))return r;const i=e.slice(0,-1);return Sn(i,t,[n,...r])}function Ds(e,t){return Sn(e,t)}function bn(e,t){if(e.length===0||e.length===1)return!1;const[r,...n]=e;return n.some(s=>t(r,s))?!0:bn(n,t)}X({reducerPath:"commands",baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getCommandCompletion:e.query({queryFn:async(t,r,n,i)=>{const c=`http://127.0.0.1:${r.getState().config.lspPort}${Li}`,o=await i({url:c,method:"POST",credentials:"same-origin",redirect:"follow",body:{query:t.query,cursor:t.cursor,top_n:t.top_n??5}}),y="@help".startsWith(t.query)&&t.query.length!==0?["@help"]:[];return o.error?{error:o.error}:Cn(o.data)?{data:{...o.data,completions:[...y,...o.data.completions]}}:Le(o.data)?{data:{completions:[...y],replace:[0,0],is_cmd_executable:!1}}:{error:{error:"Invalid response from command completion",data:o.data,status:"CUSTOM_ERROR"}}}}),getCommandPreview:e.query({queryFn:async(t,r,n,i)=>{const c=`http://127.0.0.1:${r.getState().config.lspPort}${xi}`,o=await i({url:c,method:"POST",credentials:"same-origin",redirect:"follow",body:{query:t}});return o.error?{error:o.error}:!Rn(o.data)&&!Le(o.data)?{error:{data:o.data,status:"CUSTOM_ERROR",error:"Invalid response from command preview"}}:Le(o.data)?{data:[]}:{data:o.data.messages.reduce((l,h)=>{if(h.role==="context_file"){const a=at(h.content,[]);return[...l,...a]}return[...l,h.content]},[])}}})}),refetchOnMountOrArgChange:!0});function Cn(e){return!(!e||typeof e!="object"||!("completions"in e)||!("replace"in e)||!("is_cmd_executable"in e))}function Le(e){return!(!e||typeof e!="object"||!("detail"in e))}function $s(e){return!e||typeof e!="object"||!("content"in e)||typeof e.content!="string"||!("role"in e)?!1:e.role==="context_file"||e.role==="plain_text"}function Rn(e){return!e||typeof e!="object"||!("messages"in e)||!Array.isArray(e.messages)?!1:e.messages.length?e.messages.some($s):!0}X({reducerPath:"prompts",baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getPrompts:e.query({queryFn:async(t,r,n,i)=>{const s=r.getState,o=`http://127.0.0.1:${s().config.lspPort}${zi}`,y=await i({url:o,credentials:"same-origin",redirect:"follow"});return y.error?{error:y.error}:Tn(y.data)?{data:y.data.system_prompts}:{error:{data:y.data,error:"Invalid response from server",status:"CUSTOM_ERROR"}}}})})}).endpoints;function qs(e){return!(!e||typeof e!="object"||!("text"in e)||!("description"in e))}function wn(e){if(!e||typeof e!="object")return!1;for(const t of Object.values(e))if(!qs(t))return!1;return!0}function Tn(e){return!e||typeof e!="object"||!("system_prompts"in e)||typeof e.system_prompts!="object"||e.system_prompts===null?!1:wn(e.system_prompts)}X({reducerPath:"statisticsApi",baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getStatisticData:e.query({queryFn:async(t,r,n,i)=>{const s=r.getState,o=`http://127.0.0.1:${s().config.lspPort}${Ui}`,y=await i({url:o,credentials:"same-origin",redirect:"follow"});if(y.error)return{error:y.error};if(!On(y.data))return{error:{data:y.data,error:"Invalid response from server",status:"CUSTOM_ERROR"}};try{return{data:JSON.parse(y.data.data)}}catch{return{error:{data:y.data.data,error:"Invalid response from server",originalStatus:200,status:"PARSING_ERROR"}}}}})}),refetchOnMountOrArgChange:!0});function On(e){return!e||typeof e!="object"||!("data"in e)?!1:typeof e.data=="string"}X({reducerPath:"tools",baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getTools:e.query({queryFn:async(t,r,n,i)=>{const s=r.getState,o=`http://127.0.0.1:${s().config.lspPort}${Qi}`,y=await i({url:o,credentials:"same-origin",redirect:"follow"});return y.error?y:Array.isArray(y.data)?{data:y.data.filter(h=>Ns(h))}:{error:{error:"Invalid response from tools",data:y.data,status:"CUSTOM_ERROR"}}}}),checkForConfirmation:e.mutation({queryFn:async(t,r,n,i)=>{const s=r.getState,c=s().config.lspPort,{messages:o,tool_calls:y}=t,l=ze(o),h=`http://127.0.0.1:${c}${Ki}`,a=await i({url:h,method:"POST",body:{tool_calls:y,messages:l},credentials:"same-origin",redirect:"follow"});return a.error?a:Us(a.data)?{data:a.data}:{error:{error:"Invalid response from tools",data:a.data,status:"CUSTOM_ERROR"}}}}),dryRunForEditTool:e.mutation({async queryFn(t,r,n,i){const s=r.getState,o=`http://127.0.0.1:${s().config.lspPort}${Or}`,y=await i({...n,url:o,method:"POST",body:{tool_name:t.toolName,tool_args:t.toolArgs},credentials:"same-origin",redirect:"follow"});return y.error?y:Ls(y.data)?{data:y.data}:{error:{error:`Invalid response from ${Or}`,data:y.data,status:"CUSTOM_ERROR"}}}})}),refetchOnMountOrArgChange:!0});function Ns(e){return!(!e||typeof e!="object"||!("type"in e)||!("function"in e))}function Us(e){if(!e||typeof e!="object")return!1;const t=e;if(typeof t.pause!="boolean"||!Array.isArray(t.pause_reasons))return!1;for(const r of t.pause_reasons)if(typeof r.type!="string"||typeof r.command!="string"||typeof r.rule!="string"||typeof r.tool_call_id!="string")return!1;return!0}function Ls(e){return!e||typeof e!="object"||!("file_before"in e)||typeof e.file_before!="string"||!("file_after"in e)||typeof e.file_after!="string"||!("chunks"in e)||!Array.isArray(e.chunks)?!1:e.chunks.every(Ei)}async function ut(e,t,r,n,i){const c=`http://127.0.0.1:${e.getState().config.lspPort}${n}`,o=await t({url:c,method:"GET",...r,responseHandler:"text"},e,r);return o.error?o:typeof o.data!="string"?{error:{error:`${i} path response not a string`,status:"CUSTOM_ERROR"}}:{data:o.data+i}}X({reducerPath:"pathApi",baseQuery:Y({prepareHeaders:(e,{getState:t})=>{const r=t().config.apiKey;return r&&e.set("Authorization",`Bearer ${r}`),e}}),endpoints:e=>({getFullPath:e.query({queryFn:async(t,r,n,i)=>{const c=`http://127.0.0.1:${r.getState().config.lspPort}${Wi}`,o=await i({url:c,credentials:"same-origin",redirect:"follow",method:"POST",body:{path:t}});return o.error?{error:o.error}:xs(o.data)?o.data.is_directory?{data:null}:{data:o.data.fullpath}:{meta:o.meta,error:{error:"Invalid response from fullpath",data:o.data,status:"CUSTOM_ERROR"}}}}),customizationPath:e.query({queryFn:async(t,r,n,i)=>await ut(r,i,n,je,"/customization.yaml")}),privacyPath:e.query({queryFn:async(t,r,n,i)=>await ut(r,i,n,je,"/privacy.yaml")}),bringYourOwnKeyPath:e.query({queryFn:async(t,r,n,i)=>await ut(r,i,n,je,"/bring-your-own-key.yaml")}),integrationsPath:e.query({queryFn:async(t,r,n,i)=>await ut(r,i,n,je,"/integrations.yaml")})})});function xs(e){return!(typeof e!="object"||e===null||!("fullpath"in e)||!("is_directory"in e)||typeof e.fullpath!="string"||typeof e.is_directory!="boolean")}X({reducerPath:"pingApi",baseQuery:Y({baseUrl:Er}),tagTypes:["PING"],endpoints:e=>({ping:e.query({providesTags:()=>["PING"],queryFn:async(t,r,n,i)=>{const u=`http://127.0.0.1:${r.getState().config.lspPort}${Er}`;return new Promise((c,o)=>{const y=()=>{fetch(u,{method:"GET",redirect:"follow",cache:"no-cache"}).then(l=>{if(l.ok)return l.text();throw new Error(l.statusText)}).then(l=>{c({data:l})}).catch(l=>{if(l.message==="Failed to fetch")setTimeout(y,1e3);else{const h={status:"FETCH_ERROR",error:l.message};c({error:h})}})};y()})}}),reset:e.mutation({queryFn:()=>({data:null}),invalidatesTags:["PING"]})})});function zs(e){return!e||typeof e!="object"||!("link_action"in e)||typeof e.link_action!="string"||!("link_text"in e)||typeof e.link_text!="string"||"link_goto"in e&&typeof e.link_goto!="string"?!1:e.link_action==="post-chat"?Qs(e):!0}function Qs(e){return"link_action"in e&&e.link_action==="post-chat"&&"link_payload"in e&&typeof e.link_payload=="object"&&e.link_payload!==null&&"chat_meta"in e.link_payload&&"messages"in e.link_payload}function Ks(e){return!e||typeof e!="object"||!("links"in e)||!Array.isArray(e.links)?!1:e.links.every(zs)}X({reducerPath:"linksApi",tagTypes:["Chat_Links"],baseQuery:Y({prepareHeaders:(e,{getState:t})=>{const r=t().config.apiKey;return r&&e.set("Authorization",`Bearer ${r}`),e}}),endpoints:e=>({getLinksForChat:e.query({providesTags:["Chat_Links"],async queryFn(t,r,n,i){const u=r.getState().config.lspPort,c=ze(t.messages),o=await i({...n,method:"POST",url:`http://127.0.0.1:${u}${Bi}`,body:{meta:{chat_id:t.chat_id,current:t.current_config_file,chat_mode:t.mode},messages:c,model_name:t.model}});return o.error?{error:o.error}:Ks(o.data)?{data:o.data}:{error:{error:"Invalid response for chat links",data:o.data,status:"CUSTOM_ERROR"}}}}),sendCommit:e.mutation({invalidatesTags:["Chat_Links"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Hi}`,o=await i({...n,method:"POST",url:c,body:t});return o.error?{error:o.error}:Ws(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",data:o.data,error:"Invalid response for commit"}}}})})});function Ws(e){return!(!e||typeof e!="object"||!("commits_applied"in e)||!Array.isArray(e.commits_applied)||!("error_log"in e)||!Array.isArray(e.error_log))}X({reducerPath:"integrationsApi",tagTypes:["INTEGRATIONS","INTEGRATION"],baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return e.set("credentials","same-origin"),i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getAllIntegrations:e.query({providesTags:["INTEGRATIONS"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Vi}`,o=await i({url:c,...n});return o.error?{error:o.error}:Xs(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse integrations response",data:o.data}}}}),getIntegrationByPath:e.query({providesTags:(t,r,n)=>[{type:"INTEGRATION",id:n}],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Gi}`,o=await i({url:c,method:"POST",body:{integr_config_path:t},...n});return o.error?{error:o.error}:Bs(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse integration response for: "+t,data:o.data}}}}),saveIntegration:e.mutation({invalidatesTags:(t,r,n)=>[{type:"INTEGRATION",id:n.filePath}],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Ji}`;return await i({...n,url:c,method:"POST",body:{integr_config_path:t.filePath,integr_values:t.values}})}}),deleteIntegration:e.query({providesTags:(t,r,n)=>[{type:"INTEGRATION",id:n}],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Yi}?integration_path=${t}`,o=await i({...n,url:c,method:"DELETE"});return o.error?{error:o.error}:Le(o.data)?{error:{status:"CUSTOM_ERROR",error:`Failed to delete integration by path: ${t}. Details: ${o.data.detail}`,data:o.data}}:{data:o.data}}})})});function xe(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function Bs(e){if(!e||typeof e!="object"||!("project_path"in e)||typeof e.project_path!="string"||!("integr_name"in e)||typeof e.integr_name!="string"||!("integr_config_path"in e)||typeof e.integr_config_path!="string"||!("integr_schema"in e)||!Gs(e.integr_schema)||!("integr_values"in e)||e.integr_values!==null&&typeof e.integr_values!="object")return!1;const t=e.integr_values;function r(n){return xe(n)?!0:typeof n=="object"&&n!==null?Object.values(n).every(r):!1}return!(t&&!Object.values(t).every(r)||!("error_log"in e)||!e.error_log||typeof e.error_log!="object"||!Array.isArray(e.error_log)||!e.error_log.every(En))}function Hs(e){return!(!e||typeof e!="object"||!("filter_label"in e)||typeof e.filter_label!="string"||!("filter_image"in e)||typeof e.filter_image!="string")}function Vs(e){return!(!e||typeof e!="object"||!("image"in e)||typeof e.image!="string"||!("environment"in e)||!e.environment||typeof e.environment!="object"||!Object.values(e.environment).every(xe))}function Gs(e){return!(!e||typeof e!="object"||"description"in e&&typeof e.description!="string"||!("fields"in e)||!e.fields||typeof e.fields!="object"||!Object.values(e.fields).every(Js)||!("confirmation"in e)||!e.confirmation||typeof e.confirmation!="object"||!("available"in e)||!e.available||typeof e.available!="object"||!Object.values(e.available).every(t=>typeof t=="boolean")||"smartlinks"in e&&(!e.smartlinks||!Array.isArray(e.smartlinks)||!e.smartlinks.every(Ht))||"docker"in e&&(!e.docker||typeof e.docker!="object"||!Hs(e.docker)||!("new_container_default"in e.docker)||!Vs(e.docker.new_container_default)||!("smartlinks"in e.docker)||!Array.isArray(e.docker.smartlinks)||!e.docker.smartlinks.every(Ht)||"smartlinks_for_each_container"in e.docker&&(!Array.isArray(e.docker.smartlinks_for_each_container)||!e.docker.smartlinks_for_each_container.every(Ht))))}function Js(e){return!(!e||typeof e!="object"||!("f_type"in e)||!xe(e.f_type)||"f_desc"in e&&typeof e.f_desc!="string"||"f_label"in e&&typeof e.f_label!="string"||"f_extra"in e&&typeof e.f_extra!="boolean"||"f_placeholder"in e&&!xe(e.f_placeholder)||"f_default"in e&&!xe(e.f_default)||"smartlinks"in e&&!Array.isArray(e.smartlinks))}function Ht(e){return!(!e||typeof e!="object"||!("sl_label"in e)||typeof e.sl_label!="string"||!("sl_chat"in e)||"sl_enable_only_with_tool"in e&&typeof e.sl_enable_only_with_tool!="boolean"||!Array.isArray(e.sl_chat)||!e.sl_chat.every(Ms))}function Ys(e){return!(!e||typeof e!="object"||!("project_path"in e)||typeof e.project_path!="string"||!("integr_name"in e)||typeof e.integr_name!="string"||!("icon_path"in e)||typeof e.icon_path!="string"||!("integr_config_path"in e)||typeof e.integr_config_path!="string"||!("integr_config_exists"in e)||typeof e.integr_config_exists!="boolean"||!("on_your_laptop"in e)||typeof e.on_your_laptop!="boolean"||!("when_isolated"in e)||typeof e.when_isolated!="boolean")}function En(e){return!(!e||typeof e!="object"||!("integr_config_path"in e)||typeof e.integr_config_path!="string"||!("error_line"in e)||typeof e.error_line!="number"||!("error_msg"in e)||typeof e.error_msg!="string")}function Xs(e){return!(!e||typeof e!="object"||!("integrations"in e)||!Array.isArray(e.integrations)||!e.integrations.every(Ys)||!("error_log"in e)||!Array.isArray(e.error_log)||!e.error_log.every(En))}X({reducerPath:"dockerApi",tagTypes:["DOCKER"],baseQuery:Y({prepareHeaders:(e,t)=>{const r=t.getState,i=r().config.apiKey;return e.set("credentials","same-origin"),i&&e.set("Authorization",`Bearer ${i}`),e}}),endpoints:e=>({getAllDockerContainers:e.query({providesTags:["DOCKER"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${et}`,o=await i({url:c,method:"POST",body:{},...n});return o.error?{error:o.error}:ct(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse docker containers response",data:o.data}}}}),getDockerContainersByLabel:e.query({providesTags:["DOCKER"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${et}`,o=await i({url:c,method:"POST",body:{label:t},...n});return o.error?{error:o.error}:ct(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse docker containers by labels response",data:o.data}}}}),getDockerContainersByImage:e.query({providesTags:["DOCKER"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${et}`,o=await i({url:c,method:"POST",body:{image:t},...n});return o.error?{error:o.error}:ct(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse docker containers by images response",data:o.data}}}}),getDockerContainersByImageAndLabel:e.query({providesTags:["DOCKER"],async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${et}`,o=await i({url:c,method:"POST",body:{image:t.image,label:t.label},...n});return o.error?{error:o.error}:ct(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:"Failed to parse docker containers by images response",data:o.data}}}}),executeActionForDockerContainer:e.mutation({async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${Xi}`,o=await i({url:c,method:"POST",body:{action:t.action,container:t.container},...n});return o.error?{error:{status:"CUSTOM_ERROR",error:`Failed to execute ${t.action} for docker container with ${t.container} name/id!`,data:o.error.data}}:Zs(o.data)?{data:o.data}:{error:{status:"CUSTOM_ERROR",error:`Failed to execute ${t.action} for docker container with ${t.container} name/id!`,data:o.data}}}})})});function Zs(e){return!(!e||typeof e!="object"||!("success"in e)||typeof e.success!="boolean"||!("output"in e)||typeof e.output!="string")}function ct(e){return!(!e||typeof e!="object"||!Array.isArray(e.containers)||!e.containers.every(js)||"has_connection_to_docker_daemon"in e&&typeof e.has_connection_to_docker_daemon!="boolean"||"docker_error"in e&&typeof e.docker_error!="string")}function js(e){if(!e||typeof e!="object")return!1;const t=e;return!(typeof t.id!="string"||typeof t.name!="string"||typeof t.status!="string"||typeof t.created!="string"||typeof t.user!="string"||!Array.isArray(t.env)||!t.env.every(r=>typeof r=="string")||!Array.isArray(t.command)||!t.command.every(r=>typeof r=="string")||typeof t.image!="string"||typeof t.working_dir!="string"||!ea(t.labels)||!ta(t.ports))}function ea(e){return e!=null}function ta(e){return e!=null}X({reducerPath:"telemetryApi",baseQuery:Y({prepareHeaders:(e,{getState:t})=>{const r=t().config.apiKey;return r&&e.set("Authorization",`Bearer ${r}`),e}}),endpoints:e=>({sendTelemetryChatEvent:e.query({async queryFn(t,r,n,i){const u=r.getState().config.lspPort,c=`http://127.0.0.1:${u}${Zi}`,o=await i({...n,url:c,method:"POST",body:t});return o.error?{data:(await i({...n,url:`http://127.0.0.1:${u}${Mt}`,method:"POST",body:{...t,url:Mt}})).data}:{data:o.data}}}),sendTelemetryNetEvent:e.query({async queryFn(t,r,n,i){const u=r.getState().config.lspPort;return{data:(await i({...n,url:`http://127.0.0.1:${u}${Mt}`,method:"POST",body:{...t}})).data}}})})});const An=fe({name:"knowledge",initialState:{loaded:!1,memories:{},status:null},reducers:{setVecDbStatus:(e,t)=>{e.loaded=!0,e.status=t.payload},setMemory:(e,t)=>{e.loaded=!0,e.memories[t.payload.memid]=t.payload},deleteMemory:(e,t)=>{e.loaded=!0;const{[t.payload]:r,...n}=e.memories;e.memories=n},clearMemory:e=>{e.loaded=!0,e.memories={}}},selectors:{selectVecDbStatus:e=>e.status,selectMemories:e=>e.memories,selectKnowledgeIsLoaded:e=>e.loaded}}),{setVecDbStatus:ra,setMemory:na,deleteMemory:ia,clearMemory:oa}=An.actions;An.selectors;function sa(e){return!(!e||typeof e!="object"||!("pubevent_id"in e)||typeof e.pubevent_id!="number"||!("pubevent_action"in e)||typeof e.pubevent_action!="string"||!("pubevent_json"in e)||!Pt(e.pubevent_json))}function aa(e){return!(!e||typeof e!="object"||!("pubevent_id"in e)||typeof e.pubevent_id!="number"||!("pubevent_action"in e)||typeof e.pubevent_action!="string"||!("pubevent_json"in e)||typeof e.pubevent_json!="string")}function ua(e=8001,t,r,n){const i=`http://127.0.0.1:${e}${ji}`,s=new Headers;return s.append("Content-Type","application/json"),r&&s.append("Authorization",`Bearer ${r}`),fetch(i,{method:"POST",headers:s,redirect:"follow",cache:"no-cache",body:t?JSON.stringify(t):void 0,signal:n})}Ye.withTypes()("knowledge/subscription",(e,t)=>{const r=t.getState(),n=r.config.lspPort,i=r.config.apiKey;return ua(n,e,i,t.signal).then(s=>{var y;if(!s.ok)throw new Error(s.statusText);const u=(y=s.body)==null?void 0:y.getReader();if(!u)return;t.dispatch(oa());const c=()=>{},o=l=>{if(!sa(l)&&!aa(l)&&!wr(l)){console.log("Invalid chunk from mem db",l);return}if(wr(l)){const a=ra(l);t.dispatch(a);return}const h=Pt(l.pubevent_json)?l.pubevent_json:at(l.pubevent_json,null,Pt);if(h!==null)if(l.pubevent_action==="DELETE"){const a=ia(h.memid);t.dispatch(a)}else if(l.pubevent_action==="INSERT"||l.pubevent_action==="UPDATE"){const a=na(h);t.dispatch(a)}else console.log("Unknown action",l.pubevent_action)};return Vt(u,t.signal,c,o)}).catch(s=>{console.error("Error in memory subscription",s)})});function ca(e){return!(!e||typeof e!="object"||!("memid"in e)||typeof e.memid!="string")}function fa(e){return!(!e||typeof e!="object"||!("memid"in e)||typeof e.memid!="string"||!("trajectory"in e)||typeof e.trajectory!="string")}X({reducerPath:"knowledgeApi",baseQuery:Y({prepareHeaders:(e,{getState:t})=>{const r=t().config.apiKey;return r&&e.set("Authorization",`Bearer ${r}`),e}}),endpoints:e=>({addMemory:e.mutation({async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${eo}`,o=await i({...n,url:c,method:"POST",body:{mem_type:"",origin:"",project:"",...t}});return o.error?o:ca(o.data)?{data:o.data,meta:o.meta}:{error:{status:"CUSTOM_ERROR",error:`Invalid response from ${c}`,data:o.data},meta:o.meta}}}),deleteMemory:e.mutation({async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${to}`;return await i({...n,url:c,method:"POST",body:{memid:t}})}}),updateMemory:e.mutation({async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${no}`;return await i({...n,url:c,method:"POST",body:t})}}),updateMemoryUsage:e.mutation({async queryFn(t,r,n,i){const c=`http://127.0.0.1:${r.getState().config.lspPort}${ro}`;return await i({...n,url:c,method:"POST",body:t})}}),createNewMemoryFromMessages:e.mutation({async queryFn(t,r,n,i){const s=ze(t.messages),o=`http://127.0.0.1:${r.getState().config.lspPort}${io}`,y=await i({...n,url:o,method:"POST",body:{project:t.project,messages:s}});return y.error?{error:y.error}:fa(y.data)?{data:y.data}:{error:{status:"CUSTOM_ERROR",error:`Invalid response from ${o}`,data:y.data}}}})})});function la(e){return!e||typeof e!="object"?!1:"detail"in e&&typeof e.detail=="string"}function Pn(e){const t=at(e,{});return la(t)?t:!1}function ze(e){return e.reduce((t,r)=>{if(Sr(r))return t.concat([r]);if(Ze(r))return t.concat([{role:r.role,content:r.content,tool_calls:r.tool_calls??void 0,finish_reason:r.finish_reason}]);if(Fe(r))return t.concat([{role:"tool",content:r.content.content,tool_call_id:r.content.tool_call_id}]);if(br(r)){const i={role:r.role,content:JSON.stringify(r.content),tool_call_id:r.tool_call_id};return t.concat([i])}const n=typeof r.content=="string"?r.content:JSON.stringify(r.content);return[...t,{role:r.role,content:n}]},[])}function da(e){if(e.length<8)return!1;const t=e[0]===100&&e[1]===97&&e[2]===116&&e[3]===97&&e[4]===58&&e[5]===32,r=e[e.length-2]===10&&e[e.length-1]===10;return t&&r}function pa(e){return e[0]===123&&e[1]===34&&e[2]===100&&e[3]===101&&e[4]===116&&e[5]===97&&e[6]===105&&e[7]===108&&e[8]===34&&e[9]===58}function Vt(e,t,r,n){const i=new TextDecoder;function s({done:u,value:c}){if(u)return Promise.resolve();if(t.aborted)return r(),Promise.resolve();if(pa(c)){const h=i.decode(c),a=Pn(h);if(a)throw new Error(a.detail)}const o=()=>e.read().then(h=>{if(h.done)return;const a=new Uint8Array(c.length+h.value.length);return a.set(c),a.set(h.value,c.length),s({done:u,value:a})});if(!da(c))return o();const l=i.decode(c).split(`

`).filter(h=>h.length>0);if(l.length===0)return Promise.resolve();for(const h of l){if(!h.startsWith("data: ")){console.log("Unexpected data in streaming buf: "+h);continue}const a=h.substring(6);if(a==="[DONE]")return Promise.resolve();if(a==="[ERROR]"){const _="error from lsp",b=new Error(_);return Promise.reject(b)}const d=Pn(a);if(d){const _=typeof d.detail=="string"?d.detail:JSON.stringify(d.detail),b=new Error(_);throw console.error(b),b}const g={},v=at(a,g);if(v===g)return o();n(v)}return e.read().then(s)}return e.read().then(s)}var Gt={exports:{}},Jt,Mn;function ya(){if(Mn)return Jt;Mn=1;var e=1e3,t=e*60,r=t*60,n=r*24,i=n*7,s=n*365.25;Jt=function(l,h){h=h||{};var a=typeof l;if(a==="string"&&l.length>0)return u(l);if(a==="number"&&isFinite(l))return h.long?o(l):c(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function u(l){if(l=String(l),!(l.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(h){var a=parseFloat(h[1]),d=(h[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"weeks":case"week":case"w":return a*i;case"days":case"day":case"d":return a*n;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*t;case"seconds":case"second":case"secs":case"sec":case"s":return a*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function c(l){var h=Math.abs(l);return h>=n?Math.round(l/n)+"d":h>=r?Math.round(l/r)+"h":h>=t?Math.round(l/t)+"m":h>=e?Math.round(l/e)+"s":l+"ms"}function o(l){var h=Math.abs(l);return h>=n?y(l,h,n,"day"):h>=r?y(l,h,r,"hour"):h>=t?y(l,h,t,"minute"):h>=e?y(l,h,e,"second"):l+" ms"}function y(l,h,a,d){var g=h>=a*1.5;return Math.round(l/a)+" "+d+(g?"s":"")}return Jt}function ha(e){r.debug=r,r.default=r,r.coerce=o,r.disable=s,r.enable=i,r.enabled=u,r.humanize=ya(),r.destroy=y,Object.keys(e).forEach(l=>{r[l]=e[l]}),r.names=[],r.skips=[],r.formatters={};function t(l){let h=0;for(let a=0;a<l.length;a++)h=(h<<5)-h+l.charCodeAt(a),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(l){let h,a=null,d,g;function v(..._){if(!v.enabled)return;const b=v,m=Number(new Date),f=m-(h||m);b.diff=f,b.prev=h,b.curr=m,h=m,_[0]=r.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let p=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(R,C)=>{if(R==="%%")return"%";p++;const w=r.formatters[C];if(typeof w=="function"){const T=_[p];R=w.call(b,T),_.splice(p,1),p--}return R}),r.formatArgs.call(b,_),(b.log||r.log).apply(b,_)}return v.namespace=l,v.useColors=r.useColors(),v.color=r.selectColor(l),v.extend=n,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>a!==null?a:(d!==r.namespaces&&(d=r.namespaces,g=r.enabled(l)),g),set:_=>{a=_}}),typeof r.init=="function"&&r.init(v),v}function n(l,h){const a=r(this.namespace+(typeof h>"u"?":":h)+l);return a.log=this.log,a}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let h;const a=(typeof l=="string"?l:"").split(/[\s,]+/),d=a.length;for(h=0;h<d;h++)a[h]&&(l=a[h].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){const l=[...r.names.map(c),...r.skips.map(c).map(h=>"-"+h)].join(",");return r.enable(""),l}function u(l){if(l[l.length-1]==="*")return!0;let h,a;for(h=0,a=r.skips.length;h<a;h++)if(r.skips[h].test(l))return!1;for(h=0,a=r.names.length;h<a;h++)if(r.names[h].test(l))return!0;return!1}function c(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function o(l){return l instanceof Error?l.stack||l.message:l}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var ga=ha;(function(e,t){t.formatArgs=n,t.save=i,t.load=s,t.useColors=r,t.storage=u(),t.destroy=(()=>{let o=!1;return()=>{o||(o=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let o;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(o=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(o[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(o){if(o[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+o[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const y="color: "+this.color;o.splice(1,0,y,"color: inherit");let l=0,h=0;o[0].replace(/%[a-zA-Z%]/g,a=>{a!=="%%"&&(l++,a==="%c"&&(h=l))}),o.splice(h,0,y)}t.log=console.debug||console.log||(()=>{});function i(o){try{o?t.storage.setItem("debug",o):t.storage.removeItem("debug")}catch{}}function s(){let o;try{o=t.storage.getItem("debug")}catch{}return!o&&typeof process<"u"&&"env"in process&&(o=void 0),o}function u(){try{return localStorage}catch{}}e.exports=ga(t);const{formatters:c}=e.exports;c.j=function(o){try{return JSON.stringify(o)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}}})(Gt,Gt.exports);var ma=Gt.exports;const Qe=Gr(ma),au=Qe("refact"),_a=Qe("app");Qe("component"),Qe("integrations"),Qe("tables"),typeof window<"u";const va=A("chatThread/new");A("chatThread/newIntegrationChat");const Sa=A("chatThread/response");A("chatTitleGeneration/response"),A("chatThread/askQuestion"),A("chatThread/setLastUserMessageId"),A("chatThread/setIsNewChatSuggested"),A("chatThread/setIsNewChatSuggestionRejected"),A("chatThread/backUpMessages");const kn=A("chatThread/error"),ft=A("chatThread/doneStreaming");A("chatThread/setChatModel"),A("chatThread/setSystemPrompt"),A("chatThread/removeChatFromCache"),A("chatThread/restoreChat"),A("chatThread/clearError"),A("chatThread/enableSend");const Fn=A("chatThread/preventSend");A("chatThread/setToolUse"),A("chat/setAutomaticPatch"),A("chat/setEnabledCheckpoints");const ba=A("chatThread/saveTitle");A("chatThread/setSendImmediately"),A("chatThread/setChatMode"),A("chatThread/setIntegrationData"),A("chatThread/setIsWaiting");const Ca=A("chatThread/setMaxNewTokens"),In=A("chatThread/fixBrokenToolMessages"),Dn=Ye.withTypes();Dn("chatThread/generateTitle",({messages:e,chatId:t},r)=>{const n=r.getState(),i=e.filter(c=>!Fe(c)&&!Ze(c)&&c.content!=="");_a("[DEBUG TITLE]: messagesToSend: ",i);const s=ze([...i,{role:"user",content:`Generate a short 2-3 word title for the current chat that reflects the context of the user's query. The title should be specific, avoiding generic terms, and should relate to relevant files, symbols, or objects. If user message contains filename, please make sure that filename remains inside of a generated title. Please ensure the answer is strictly 2-3 words, not paragraphs of text.
Output should be STRICTLY 2-3 words, not explanation.`,checkpoints:[]}]),u=[];return Fs({messages:s,model:n.chat.thread.model,stream:!0,abortSignal:r.signal,chatId:t,apiKey:n.config.apiKey,port:n.config.lspPort}).then(c=>{var h;if(!c.ok)return Promise.reject(new Error(c.statusText));const o=(h=c.body)==null?void 0:h.getReader();if(!o)return;const y=()=>r.dispatch(Fn({id:t})),l=a=>{u.push(a)};return Vt(o,r.signal,y,l)}).catch(c=>(r.dispatch(ft({id:t})),r.dispatch(kn({id:t,message:c.message})),r.rejectWithValue(c.message))).finally(()=>{const c=u.reduce((o,y)=>Rr(y)&&Cr(y.choices[0].delta)?o+y.choices[0].delta.content:o,"");r.dispatch(ba({id:t,title:c,isTitleGenerated:!0})),r.dispatch(ft({id:t}))})});function Ra(e){const t=Ds(e,s=>Fe(s)||At(s)||Mi(s));if(t.length===0)return!1;const r=t.reduce((s,u)=>At(u)?s.concat(u.tool_calls):s,[]);if(r.length===0)return!1;const n=t.filter(Fe);return bn(r,(s,u)=>{const c=n.find(y=>y.content.tool_call_id===s.id),o=n.find(y=>y.content.tool_call_id===u.id);return s.function.name===u.function.name&&s.function.arguments===u.function.arguments&&!!c&&!!o&&c.content.content===o.content.content})}Dn("chatThread/sendChat",({messages:e,chatId:t,tools:r,mode:n,toolsConfirmed:i,checkpointsEnabled:s},u)=>{const c=u.getState(),o=t in c.chat.cache?c.chat.cache[t]:c.chat.thread.id===t?c.chat.thread:null,y=Ra(e),l=ze(e),h=n??(o==null?void 0:o.mode),a=o==null?void 0:o.last_user_message_id;return ks({messages:l,last_user_message_id:a,model:c.chat.thread.model,tools:r,stream:!0,abortSignal:u.signal,max_new_tokens:c.chat.max_new_tokens,chatId:t,apiKey:c.config.apiKey,port:c.config.lspPort,onlyDeterministicMessages:y,toolsConfirmed:i,checkpointsEnabled:s,integration:o==null?void 0:o.integration,mode:h}).then(d=>{var b;if(!d.ok)return Promise.reject(new Error(d.statusText));const g=(b=d.body)==null?void 0:b.getReader();if(!g)return;const v=()=>{u.dispatch(Fn({id:t})),u.dispatch(In({id:t}))},_=m=>{const f=Sa({...m,id:t});return u.dispatch(f)};return Vt(g,u.signal,v,_)}).catch(d=>(u.dispatch(ft({id:t})),u.dispatch(kn({id:t,message:d.message})),u.dispatch(In({id:t})),u.rejectWithValue(d.message))).finally(()=>{u.dispatch(Ca(Ps)),u.dispatch(ft({id:t}))})});const wa=A("fim/request"),Ta=A("fim/receive"),Oa=A("fim/error"),Ea=A("fim/ready");A("fim/clear_error"),A("fim/reset");const Aa={host:"web",lspPort:8001,apiKey:null,features:{statistics:!0,vecdb:!0,ast:!0,images:!0,knowledge:!1},themeProps:{appearance:"dark"},shiftEnterToSubmit:!1},$n=A("config/update"),Pa=A("config/setThemeMode"),Ma=A("config/setApiKey"),ka=A("config/setAddressURL"),Fa=A("config/feature/change");Pe(Aa,e=>{e.addCase($n,(t,r)=>{t.dev=r.payload.dev??t.dev,t.features=r.payload.features?{...t.features,...r.payload.features}:t.features,t.host=r.payload.host??t.host,t.lspUrl=r.payload.lspUrl??t.lspUrl,t.tabbed=r.payload.tabbed??t.tabbed,t.themeProps=r.payload.themeProps??t.themeProps,t.apiKey=r.payload.apiKey??t.apiKey,t.addressURL=r.payload.addressURL??t.addressURL,t.lspPort=r.payload.lspPort??t.lspPort,t.keyBindings=r.payload.keyBindings??t.keyBindings,t.shiftEnterToSubmit=r.payload.shiftEnterToSubmit??t.shiftEnterToSubmit}),e.addCase(Pa,(t,r)=>{t.themeProps.appearance=r.payload}),e.addCase(Ma,(t,r)=>{t.apiKey=r.payload}),e.addCase(Fa,(t,r)=>{t.features={...t.features??{},[r.payload.feature]:r.payload.value}}),e.addCase(ka,(t,r)=>{t.addressURL=r.payload})});const Yt=e=>e.config.features;pe(Yt,e=>e==null?void 0:e.vecdb),pe(Yt,e=>e==null?void 0:e.ast),pe(Yt,e=>e==null?void 0:e.knowledge);const Ia={name:"",line1:null,line2:null,can_paste:!1,path:"",cursor:null},qn=A("activeFile/setFileInfo");Pe(Ia,e=>{e.addCase(qn,(t,r)=>({...t,...r.payload}))});const Da={language:"",code:"",path:"",basename:""},Nn=A("selected_snippet/set");Pe(Da,e=>{e.addCase(Nn,(t,r)=>r.payload)});const $a=A("textarea/add"),qa=A("textarea/replace"),Na={name:""},Un=A("currentProjectInfo/setCurrentProjectInfo");Pe(Na,e=>{e.addCase(Un,(t,r)=>r.payload)});var Xt=(e=>(e.SETUP_HOST="setup_host",e.OPEN_EXTERNAL_URL="open_external_url",e.LOG_OUT="log_out",e))(Xt||{});function lt(e){if(!e||typeof e!="object"||!("type"in e)||typeof e.type!="string")return!1;const t={...Xt};return Object.values(t).includes(e.type)}function Ua(e){return lt(e)?e.type==="setup_host":!1}function La(e){return lt(e)?e.type==="open_external_url":!1}function xa(e){return lt(e)?e.type==="log_out":!1}const za=A("ide/diffPasteBack"),Qa=A("ide/openSettings"),Ka=A("ide/newFile"),Wa=A("ide/openHotKeys"),Ba=A("ide/openFile"),Ha=A("ide/openChatInNewTab"),Va=A("ide/animateFile/start"),Ga=A("ide/animateFile/stop"),Ja=A("ide/chatPageChange"),Ya=A("ide/escapeKeyPressed"),Xa=A("ide/isChatStreaming"),Za=A("ide/isChatReady"),ja=A("ide/toolEdit"),eu={request:wa,ready:Ea,receive:Ta,error:Oa};M.EVENT_NAMES_FROM_SETUP=Xt,M.addInputValue=$a,M.fim=eu,M.ideAnimateFileStart=Va,M.ideAnimateFileStop=Ga,M.ideChatPageChange=Ja,M.ideDiffPasteBackAction=za,M.ideEscapeKeyPressed=Ya,M.ideIsChatReady=Za,M.ideIsChatStreaming=Xa,M.ideNewFileAction=Ka,M.ideOpenChatInNewTab=Ha,M.ideOpenFile=Ba,M.ideOpenHotKeys=Wa,M.ideOpenSettingsAction=Qa,M.ideToolEdit=ja,M.isActionFromSetup=lt,M.isAssistantDelta=Cr,M.isAssistantMessage=Ze,M.isCapsResponse=vn,M.isChatContextFileDelta=ki,M.isChatContextFileMessage=Ai,M.isChatResponseChoice=Rr,M.isChatUserMessageResponse=Ii,M.isCommandCompletionResponse=Cn,M.isCommandPreviewResponse=Rn,M.isCustomPromptsResponse=Tn,M.isDetailMessage=Le,M.isDiffMessage=br,M.isDiffResponse=$i,M.isLogOut=xa,M.isOpenExternalUrl=La,M.isPlainTextMessage=Pi,M.isPlainTextResponse=qi,M.isSetupHost=Ua,M.isStatisticDataResponse=On,M.isSystemPrompts=wn,M.isToolCallDelta=Fi,M.isToolCallMessage=At,M.isToolMessage=Fe,M.isToolResponse=Di,M.isUserMessage=Sr,M.newChatAction=va,M.setCurrentProjectInfo=Un,M.setFileInfo=qn,M.setInputValue=qa,M.setSelectedSnippet=Nn,M.updateConfig=$n,Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})});
