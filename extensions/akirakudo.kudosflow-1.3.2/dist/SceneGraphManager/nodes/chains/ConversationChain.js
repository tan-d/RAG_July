const a4_0x4481b0=a4_0x1ddc;(function(_0x85ff93,_0x3ca3db){const _0x80a989=a4_0x1ddc,_0x7a5abe=_0x85ff93();while(!![]){try{const _0x29c9d6=-parseInt(_0x80a989(0x18c))/0x1+-parseInt(_0x80a989(0x138))/0x2+-parseInt(_0x80a989(0x15b))/0x3*(parseInt(_0x80a989(0x135))/0x4)+parseInt(_0x80a989(0x15c))/0x5*(parseInt(_0x80a989(0x18a))/0x6)+parseInt(_0x80a989(0x193))/0x7+-parseInt(_0x80a989(0x17c))/0x8+parseInt(_0x80a989(0x155))/0x9;if(_0x29c9d6===_0x3ca3db)break;else _0x7a5abe['push'](_0x7a5abe['shift']());}catch(_0x2f3a0e){_0x7a5abe['push'](_0x7a5abe['shift']());}}}(a4_0x2393,0x2c5fc));const a4_0x46eba3=(function(){const _0x289ebd=a4_0x1ddc,_0xbf668f={};_0xbf668f[_0x289ebd(0x161)]=function(_0x43c678,_0x102571){return _0x43c678===_0x102571;},_0xbf668f[_0x289ebd(0x17d)]='emduu',_0xbf668f[_0x289ebd(0x17e)]=_0x289ebd(0x13c);const _0x526d59=_0xbf668f;let _0x2f3e7e=!![];return function(_0x26818e,_0x2a770c){const _0x4b3da6=_0x2f3e7e?function(){const _0x30adbe=a4_0x1ddc;if(_0x2a770c){if(_0x526d59[_0x30adbe(0x161)](_0x526d59[_0x30adbe(0x17d)],_0x526d59[_0x30adbe(0x17e)])){const _0x125e8f=_0x40a8ad[_0x30adbe(0x182)](_0x4b9166,arguments);return _0x187d08=null,_0x125e8f;}else{const _0x6dc4e6=_0x2a770c[_0x30adbe(0x182)](_0x26818e,arguments);return _0x2a770c=null,_0x6dc4e6;}}}:function(){};return _0x2f3e7e=![],_0x4b3da6;};}()),a4_0x2a2219=a4_0x46eba3(this,function(){const _0x3f3f7a=a4_0x1ddc,_0xc98da1={};_0xc98da1[_0x3f3f7a(0x152)]='(((.+)+)+)+$';const _0x3264d7=_0xc98da1;return a4_0x2a2219[_0x3f3f7a(0x171)]()[_0x3f3f7a(0x141)](_0x3264d7['PPlbD'])['toString']()[_0x3f3f7a(0x160)](a4_0x2a2219)[_0x3f3f7a(0x141)](_0x3f3f7a(0x189));});a4_0x2a2219();const a4_0x122fd3=(function(){const _0xd00868=a4_0x1ddc,_0x1c0a8c={};_0x1c0a8c[_0xd00868(0x136)]=_0xd00868(0x147);const _0x3eb777=_0x1c0a8c;let _0x3a2075=!![];return function(_0x49f6d1,_0x2d2c22){const _0x1f6ce0=_0x3a2075?function(){const _0x239612=a4_0x1ddc;if(_0x3eb777[_0x239612(0x136)]!==_0x239612(0x16b)){if(_0x2d2c22){const _0x238671=_0x2d2c22[_0x239612(0x182)](_0x49f6d1,arguments);return _0x2d2c22=null,_0x238671;}}else _0x50bfde=_0x524cb4;}:function(){};return _0x3a2075=![],_0x1f6ce0;};}()),a4_0x5a110d=a4_0x122fd3(this,function(){const _0x20340b=a4_0x1ddc,_0x2b6ed8={'WHLbQ':_0x20340b(0x180),'dvxix':function(_0x1d8540,_0x552e1b){return _0x1d8540(_0x552e1b);},'SVsmk':_0x20340b(0x16a),'gzbXE':function(_0x31c311){return _0x31c311();},'LEIol':'LqyZW','VQfvW':_0x20340b(0x13d),'IWWzM':_0x20340b(0x18e),'NdCbp':_0x20340b(0x139),'GfKWW':'info','AyYev':_0x20340b(0x134),'gjIGN':_0x20340b(0x137),'CnYkQ':function(_0x10a462,_0x42f333){return _0x10a462<_0x42f333;}};let _0x10969e;try{const _0xb597e=_0x2b6ed8[_0x20340b(0x191)](Function,_0x2b6ed8[_0x20340b(0x175)]+_0x20340b(0x190)+');');_0x10969e=_0x2b6ed8[_0x20340b(0x172)](_0xb597e);}catch(_0x61d15d){if(_0x2b6ed8[_0x20340b(0x150)]===_0x2b6ed8[_0x20340b(0x13b)])throw new _0x12ce96(_0x2b6ed8['WHLbQ']);else _0x10969e=window;}const _0x247591=_0x10969e[_0x20340b(0x159)]=_0x10969e[_0x20340b(0x159)]||{},_0x431c12=[_0x2b6ed8[_0x20340b(0x188)],_0x2b6ed8[_0x20340b(0x17a)],_0x2b6ed8[_0x20340b(0x14f)],_0x20340b(0x13a),'exception',_0x2b6ed8[_0x20340b(0x15f)],_0x2b6ed8[_0x20340b(0x16c)]];for(let _0x4f7889=0x0;_0x2b6ed8[_0x20340b(0x154)](_0x4f7889,_0x431c12[_0x20340b(0x170)]);_0x4f7889++){const _0x43cbf9=a4_0x122fd3['constructor'][_0x20340b(0x166)][_0x20340b(0x192)](a4_0x122fd3),_0x2c1a3e=_0x431c12[_0x4f7889],_0x46f939=_0x247591[_0x2c1a3e]||_0x43cbf9;_0x43cbf9[_0x20340b(0x176)]=a4_0x122fd3[_0x20340b(0x192)](a4_0x122fd3),_0x43cbf9['toString']=_0x46f939[_0x20340b(0x171)][_0x20340b(0x192)](_0x46f939),_0x247591[_0x2c1a3e]=_0x43cbf9;}});a4_0x5a110d();'use strict';const a4_0x233c89={};a4_0x233c89[a4_0x4481b0(0x18f)]=!![],Object[a4_0x4481b0(0x163)](exports,'__esModule',a4_0x233c89),exports['ConversationChain']=void 0x0;function a4_0x2393(){const _0x28f0c2=['B3bwq3y','Aw5PDgLHBgL6zq','C2vHCMnO','C2f2zunVBNrLEhq','sfflrgi','y29UDgvUDa','C3rYzwfT','E2LUChv0Fq','vLDZBgC','DufKEfm','wLf0DuG','C3rYAw5N','C3vJy2vZCW','zM9YBwf0uhjVBxb0vMfSDwu','wu5zteW','B3v0Chv0','r2zlv1C','tevjB2W','lI9cyxnLq2HHAw5oB2rL','ufbSyKq','rLbutNa','q25zA1e','mZC5nZu5nwf3qwvqvG','qgXHBMDJAgfPBI9JB3jLl3bYB21WDhm','ChjVBxb0','BgfUz2nOywLUl2nOywLUCW','y29UC29Szq','ufH0EuK','mtaXmZm2n1zXuxjPyG','mte5nvbxsw5ZtW','tNPquxm','wKL5uNq','qxLzzxy','y29UC3rYDwn0B3i','zKLdAu8','q29UDMvYC2f0Aw9Uq2HHAw4','zgvMAw5LuhjVCgvYDhK','EgDVBu4','q2HHDfbYB21WDfrLBxbSyxrL','ChjVDg90ExbL','DfbSrLq','Aw52B2TL','DM9OsNe','CMv0DxjUicHMDw5JDgLVBIGPia','tLj6rMe','z2Pjr04','D3DxyM4','Dgv4Da','CMvZCg9UC2u','BgvUz3rO','Dg9tDhjPBMC','z3PIweu','C3LZDgvTtwvZC2fNzvbYB21WDa','vLPxtNC','u1zZBwS','x19WCM90B19F','Ee5lq0e','tefor0niquLox1zfuKjpu0u','sgnRrvK','tMrdyNa','zNjVBu1LC3nHz2vZ','mJaZnZe5mKTcwenzvW','qMzozMW','tuzVA2O','zw52','q2HHAw4GBM90igLUAxrPywXPEMvK','rxjYB3iGAw4Gq29UDMvYC2f0Aw9Uq2HHAw4GCxvLCNK6','yxbWBhK','y2HHDfbYB21WDfrLBxbSyxrL','vw5RBM93BIbLCNjVCIbVy2n1CNjLza','y2HHDf9OAxn0B3j5','ChjLCgfYzuLUChv0v2L0AeLTywDL','BgXTA3G','svDxEK0','kcGOlISPkYKRksSK','nJi3nKzowMLqAG','BgfUz0nOywLUsw5ZDgfUy2u','mJq5odvRBhjwtwS','uLPiCvK','Bg9N','DMfSDwu','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','zhz4AxG','yMLUza','mty2mZGWoxnOEezuDW','Aw5PDgLHBgL6zu1VzgvSqw5KtwvTB3j5','A0TfBfa','tNruC0y','DgfIBgu','nenXwxHOra','sMDpBem','DhjHy2u','mJiWote0D1Lhr1L6','D2fYBG','zxjYB3i','vLfMDLC','CxvwqLO','BfDsBfa','zNjVBvrLBxbSyxrL'];a4_0x2393=function(){return _0x28f0c2;};return a4_0x2393();}const chains_1=require(a4_0x4481b0(0x158)),prompts_1=require(a4_0x4481b0(0x156)),BaseChainNode_1=require(a4_0x4481b0(0x151));class ConversationChain extends BaseChainNode_1['BaseChainNode']{async[a4_0x4481b0(0x140)](_0x5df1da){const _0x4d97ca=a4_0x4481b0,_0x23b8d0={};_0x23b8d0[_0x4d97ca(0x16d)]=function(_0x44592f,_0x153d8c){return _0x44592f===_0x153d8c;},_0x23b8d0[_0x4d97ca(0x177)]=_0x4d97ca(0x195),_0x23b8d0[_0x4d97ca(0x153)]=_0x4d97ca(0x174),_0x23b8d0['IvVDI']='The\x20following\x20is\x20a\x20friendly\x20conversation\x20between\x20a\x20human\x20and\x20an\x20AI.\x20The\x20AI\x20is\x20talkative\x20and\x20provides\x20lots\x20of\x20specific\x20details\x20from\x20its\x20context.\x20If\x20the\x20AI\x20does\x20not\x20know\x20the\x20answer\x20to\x20a\x20question,\x20it\x20truthfully\x20says\x20it\x20does\x20not\x20know.',_0x23b8d0['YNYLL']=_0x4d97ca(0x146),_0x23b8d0['NzPQs']=function(_0x3a4639,_0x26d32f){return _0x3a4639===_0x26d32f;},_0x23b8d0[_0x4d97ca(0x169)]='true';const _0x36f30c=_0x23b8d0,{nodeId:_0x2b2a0c,findConnectedNode:_0x16d02a,nodeHandlers:_0x1021da}=_0x5df1da,{modelInstance:_0x378597,memoryInstance:_0x31e4a4}=await this[_0x4d97ca(0x194)](_0x2b2a0c,_0x16d02a,_0x1021da);let _0x3f2c1d;if(_0x5df1da[_0x4d97ca(0x183)])_0x3f2c1d=_0x5df1da[_0x4d97ca(0x183)];else{if(_0x36f30c[_0x4d97ca(0x16d)](_0x36f30c[_0x4d97ca(0x177)],_0x36f30c[_0x4d97ca(0x153)])){if(_0x31c595){const _0x348cd2=_0x512469['apply'](_0x203538,arguments);return _0x5a5850=null,_0x348cd2;}}else _0x3f2c1d=prompts_1[_0x4d97ca(0x165)][_0x4d97ca(0x17b)]([prompts_1['SystemMessagePromptTemplate'][_0x4d97ca(0x13e)](_0x5df1da[_0x4d97ca(0x173)]||_0x36f30c['IvVDI']),new prompts_1['MessagesPlaceholder']('chat_history'),prompts_1['HumanMessagePromptTemplate'][_0x4d97ca(0x13e)](_0x36f30c[_0x4d97ca(0x14d)])]);}const _0x1e1ea9=new chains_1[(_0x4d97ca(0x162))]({'llm':_0x378597,'memory':_0x31e4a4,'prompt':_0x3f2c1d,'verbose':_0x36f30c[_0x4d97ca(0x15d)](process[_0x4d97ca(0x17f)][_0x4d97ca(0x178)],_0x36f30c[_0x4d97ca(0x169)])});return this[_0x4d97ca(0x18b)]=_0x1e1ea9,this;}async['invoke'](_0x4893ab,_0x3b6f60={}){const _0x4848bc=a4_0x4481b0,_0x33ec34={};_0x33ec34[_0x4848bc(0x149)]=function(_0x5e6072,_0x4452af){return _0x5e6072 instanceof _0x4452af;},_0x33ec34[_0x4848bc(0x15a)]=_0x4848bc(0x184);const _0x57fb43=_0x33ec34;if(!this[_0x4848bc(0x18b)])throw new Error('Chain\x20not\x20initialized');try{const _0x4d707a=this[_0x4848bc(0x186)](_0x4893ab,_0x3b6f60),_0xb13904=await this[_0x4848bc(0x18b)]['call'](_0x4d707a),_0x36c4f1={};return _0x36c4f1[_0x4848bc(0x16f)]=_0xb13904[_0x4848bc(0x16f)],_0x36c4f1['success']=!![],_0x36c4f1;}catch(_0x5cd120){return console[_0x4848bc(0x13a)](_0x4848bc(0x181),_0x5cd120),{'error':_0x57fb43[_0x4848bc(0x149)](_0x5cd120,Error)?_0x5cd120['message']:_0x57fb43[_0x4848bc(0x15a)],'success':![]};}}async*['stream'](_0x422631,_0x5c263f={}){const _0xe98c9c=a4_0x4481b0,_0xf67431={'ZNFgB':function(_0x497a12,_0x41aa2a){return _0x497a12(_0x41aa2a);},'tPlFT':function(_0x5bfa5e,_0x351878){return _0x5bfa5e+_0x351878;},'uAdxS':function(_0xbcf6c5,_0x26a511){return _0xbcf6c5+_0x26a511;},'HQKDb':'return\x20(function()\x20','opVCv':_0xe98c9c(0x190),'xgomN':function(_0x55c9ce){return _0x55c9ce();},'nTHVk':'Chain\x20not\x20initialized','llmkx':function(_0x4b8df3,_0x15d0e2){return _0x4b8df3 in _0x15d0e2;},'OJAUk':_0xe98c9c(0x184),'HckEY':function(_0xa99e09,_0xe3597c){return _0xa99e09===_0xe3597c;},'ZIyRt':_0xe98c9c(0x196),'RZHqY':'Error\x20in\x20ConversationChain\x20streamQuery:'};if(!this[_0xe98c9c(0x18b)])throw new Error(_0xf67431['nTHVk']);try{const _0x277b76=this[_0xe98c9c(0x18b)]['llm'];if(!_0xf67431[_0xe98c9c(0x187)](_0xe98c9c(0x145),_0x277b76)){const _0x38a407=await this[_0xe98c9c(0x168)](_0x422631,_0x5c263f);if(_0x38a407[_0xe98c9c(0x14b)])yield _0x38a407['response'];else throw new Error(_0x38a407['error']||_0xf67431['OJAUk']);return;}const _0x30bdda=this[_0xe98c9c(0x18b)]['memory'];let _0x4a2dd8=[];if(_0x30bdda){const _0x28e497=await _0x30bdda['loadMemoryVariables']({});_0x4a2dd8=_0x28e497[_0xe98c9c(0x185)]||[];}const _0x10ec4a=this[_0xe98c9c(0x186)](_0x422631,_0x5c263f),_0x3ff8fd=this[_0xe98c9c(0x18b)][_0xe98c9c(0x157)],_0x30b974={..._0x10ec4a,'chat_history':_0x4a2dd8,..._0x5c263f},_0x22a74c=await _0x3ff8fd[_0xe98c9c(0x14c)](_0x30b974),_0x47750d=await _0x277b76[_0xe98c9c(0x145)](_0x22a74c['toChatMessages']());let _0x3aa1c4='';for await(const _0x23a657 of _0x47750d){const _0x4f5bb9=typeof _0x23a657===_0xe98c9c(0x14a)?_0x23a657:_0x23a657[_0xe98c9c(0x144)]||_0x23a657[_0xe98c9c(0x16e)]||'';_0x3aa1c4+=_0x4f5bb9,yield _0x4f5bb9;}if(_0x30bdda){if(_0xf67431[_0xe98c9c(0x179)](_0xf67431[_0xe98c9c(0x15e)],_0xf67431[_0xe98c9c(0x15e)])){const _0x18e00b={};_0x18e00b['input']=_0x422631;const _0x3e734c={};_0x3e734c[_0xe98c9c(0x14e)]=_0x3aa1c4,await _0x30bdda[_0xe98c9c(0x142)](_0x18e00b,_0x3e734c);}else{const _0x41cb55=PFUlnx['ZNFgB'](_0x59f613,PFUlnx[_0xe98c9c(0x167)](PFUlnx[_0xe98c9c(0x148)](PFUlnx[_0xe98c9c(0x143)],PFUlnx[_0xe98c9c(0x13f)]),');'));_0x32cb97=PFUlnx[_0xe98c9c(0x164)](_0x41cb55);}}}catch(_0x5a9784){console[_0xe98c9c(0x13a)](_0xf67431[_0xe98c9c(0x18d)],_0x5a9784);throw _0x5a9784;}}}function a4_0x1ddc(_0x3dc82a,_0x2f70ce){const _0xb249ee=a4_0x2393();return a4_0x1ddc=function(_0x5a110d,_0x122fd3){_0x5a110d=_0x5a110d-0x134;let _0x124e04=_0xb249ee[_0x5a110d];if(a4_0x1ddc['erRKYv']===undefined){var _0x4ffe60=function(_0x1ddc81){const _0x365ad7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2c2511='',_0x31e671='',_0x4ced49=_0x2c2511+_0x4ffe60;for(let _0x5c6b74=0x0,_0x2d00d1,_0x42f2b2,_0x35e53a=0x0;_0x42f2b2=_0x1ddc81['charAt'](_0x35e53a++);~_0x42f2b2&&(_0x2d00d1=_0x5c6b74%0x4?_0x2d00d1*0x40+_0x42f2b2:_0x42f2b2,_0x5c6b74++%0x4)?_0x2c2511+=_0x4ced49['charCodeAt'](_0x35e53a+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x2d00d1>>(-0x2*_0x5c6b74&0x6)):_0x5c6b74:0x0){_0x42f2b2=_0x365ad7['indexOf'](_0x42f2b2);}for(let _0x578f53=0x0,_0x2ebf4d=_0x2c2511['length'];_0x578f53<_0x2ebf4d;_0x578f53++){_0x31e671+='%'+('00'+_0x2c2511['charCodeAt'](_0x578f53)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x31e671);};a4_0x1ddc['SPCFMb']=_0x4ffe60,_0x3dc82a=arguments,a4_0x1ddc['erRKYv']=!![];}const _0x2a2219=_0xb249ee[0x0],_0x46eba3=_0x5a110d+_0x2a2219,_0x23932a=_0x3dc82a[_0x46eba3];if(!_0x23932a){const _0x3360da=function(_0x19cd58){this['FejcYF']=_0x19cd58,this['WJHcGS']=[0x1,0x0,0x0],this['HdhlMm']=function(){return'newState';},this['pbSVUO']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['dntvHl']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3360da['prototype']['zvfEyi']=function(){const _0x5b3430=new RegExp(this['pbSVUO']+this['dntvHl']),_0x382330=_0x5b3430['test'](this['HdhlMm']['toString']())?--this['WJHcGS'][0x1]:--this['WJHcGS'][0x0];return this['KCgGJr'](_0x382330);},_0x3360da['prototype']['KCgGJr']=function(_0x3fc11b){if(!Boolean(~_0x3fc11b))return _0x3fc11b;return this['xhwZca'](this['FejcYF']);},_0x3360da['prototype']['xhwZca']=function(_0x10c2b3){for(let _0x10701a=0x0,_0x56d30c=this['WJHcGS']['length'];_0x10701a<_0x56d30c;_0x10701a++){this['WJHcGS']['push'](Math['round'](Math['random']())),_0x56d30c=this['WJHcGS']['length'];}return _0x10c2b3(this['WJHcGS'][0x0]);},new _0x3360da(a4_0x1ddc)['zvfEyi'](),_0x124e04=a4_0x1ddc['SPCFMb'](_0x124e04),_0x3dc82a[_0x46eba3]=_0x124e04;}else _0x124e04=_0x23932a;return _0x124e04;},a4_0x1ddc(_0x3dc82a,_0x2f70ce);}exports[a4_0x4481b0(0x162)]=ConversationChain;